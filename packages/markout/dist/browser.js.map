{"version":3,"file":"browser.js","sources":["../../browser/dynamic-import.js","../../packages/markout/lib/entities.js","../../packages/markout/lib/content/dom/normalizer.js","../../packages/markout/lib/content/dom/renderer.js","../../packages/markout/lib/content/dom.js","../../packages/markout/elements/markout-content.js","../../packages/markout/lib/hashout.js","../../packages/markout/lib/browser.js"],"sourcesContent":["﻿export default async function dynamicImport(specifier, referrer) {\n\tif (!('resolve' in dynamicImport)) {\n\t\tconst {assign, create, defineProperties, freeze, getOwnPropertyDescriptors, setPrototypeOf} = Object;\n\t\tlet base;\n\t\tconst resolve = freeze((specifier, referrer) => `${new URL(specifier, referrer || base || location)}`);\n\t\tconst properties = {resolve};\n\t\ttry {\n\t\t\tproperties.import = freeze((1, eval)(`url => import(url)`));\n\t\t\tproperties.export = freeze(() => {\n\t\t\t\tthrow Error(`Invalid invokation of dynamicImport.exports()`);\n\t\t\t});\n\t\t} catch (exception) {\n\t\t\tconst reflect = freeze(getOwnPropertyDescriptors.bind(null));\n\t\t\tconst createElement = document.createElement.bind(document);\n\t\t\tconst insertElement = document.appendChild.bind(document.head);\n\t\t\tconst records = {};\n\t\t\tconst resolvers = {};\n\t\t\tconst binders = new WeakMap();\n\t\t\tconst proxy = new Proxy(freeze(create(null)), {\n\t\t\t\tget: (target, property, receiver) => {\n\t\t\t\t\tconst binder = binders.get(receiver);\n\t\t\t\t\tif (binder && binders.delete(setPrototypeOf(receiver, null)))\n\t\t\t\t\t\treturn freeze(defineProperties(receiver, {...binder(reflect), ...reflect(receiver)}))[property];\n\t\t\t\t},\n\t\t\t});\n\t\t\tconst Import = class Import {\n\t\t\t\tconstructor(url) {\n\t\t\t\t\tconst {wrap = Import.wrap, inject = Import.inject} = new.target;\n\t\t\t\t\tthis.url = url;\n\t\t\t\t\tthis.namespace = create(proxy, {\n\t\t\t\t\t\t[Symbol.toStringTag]: {value: `Module‹${url}›`},\n\t\t\t\t\t});\n\t\t\t\t\tthis.source = wrap(url, (this.binder = `reflect => reflect(namespace)`), (this.loader = import.meta.url));\n\t\t\t\t\tthis.promise = inject(this);\n\t\t\t\t\tfreeze(this);\n\t\t\t\t}\n\t\t\t\tstatic wrap(url, binder, loader) {\n\t\t\t\t\treturn `import * as namespace from \"${url}\";\\nimport loader from \"${loader}\";\\nloader.export(\"${url}\", ${binder});`;\n\t\t\t\t}\n\t\t\t\tstatic inject({url, source: textContent, namespace, crossOrigin = 'anonymous', type = 'module'}) {\n\t\t\t\t\tlet timeout;\n\t\t\t\t\tconst script = assign(createElement('script'), {type: 'module', crossOrigin, textContent});\n\t\t\t\t\tconst promise = new Promise(\n\t\t\t\t\t\tresolve => (timeout = setTimeout((script.onerror = resolvers[url] = resolve), 5000, {type: 'timeout'})),\n\t\t\t\t\t).then(event => {\n\t\t\t\t\t\tresolvers[url] = script.onerror = void clearTimeout(timeout);\n\t\t\t\t\t\tif (!event || event.type === 'load') return namespace;\n\t\t\t\t\t\tthrow Error(`Failed to load \"${url}\"`);\n\t\t\t\t\t});\n\t\t\t\t\tinsertElement(script).remove();\n\t\t\t\t\treturn promise;\n\t\t\t\t}\n\t\t\t};\n\n\t\t\tfreeze(freeze(Import.prototype).constructor);\n\n\t\t\tproperties.import = freeze(url => {\n\t\t\t\tconst {[url]: record = (records[url] = new Import(resolve(url)))} = records;\n\t\t\t\treturn record.promise;\n\t\t\t});\n\n\t\t\tproperties.export = freeze((url, binder) => {\n\t\t\t\tconst {[url]: record} = records;\n\t\t\t\tif (!record || typeof binder !== 'function' || `${binder}` !== record.binder || binders.has(record.namesapce))\n\t\t\t\t\tthrow Error(`Invalid invokation of dynamicImport.exports()`);\n\t\t\t\tbinders.set(record.namespace, binder);\n\t\t\t\tresolvers[url] && resolvers[url]();\n\t\t\t});\n\t\t}\n\n\t\tdefineProperties(dynamicImport, {\n\t\t\t...getOwnPropertyDescriptors(freeze(properties)),\n\t\t\tbase: {get: () => base, set: value => (base = `${new URL(value)}`)},\n\t\t});\n\t}\n\treturn dynamicImport.import(dynamicImport.resolve(specifier, referrer));\n}\n","﻿import {entities} from '/markup/dist/tokenizer.browser.js';\n\nexport const {\n\tUnicodeIdentifier,\n\tMarkdownIdentityPrefixer,\n\tMarkdownIdentityJoiner,\n\tMarkdownIdentityWord,\n\tMarkdownIdentity,\n} = (({\n\traw = String.raw,\n\tIdentifierStart,\n\tIdentifierPart,\n\tUnicodeIdentifierStart = IdentifierStart.slice(2),\n\tUnicodeIdentifierPart = IdentifierPart.slice(2),\n\tUnicodeIdentifier = raw`[\\d${UnicodeIdentifierStart}][\\d${UnicodeIdentifierPart}]*`,\n\tMarkdownWordPrefixes = raw`$@`,\n\tMarkdownWordPrefix = raw`[${MarkdownWordPrefixes}]?`,\n\tMarkdownWord = raw`${MarkdownWordPrefix}${UnicodeIdentifier}`,\n\tMarkdownWordJoiners = raw` \\\\\\/:_\\-\\xA0\\u2000-\\u200B\\u202F\\u2060`,\n\tMarkdownWordJoiner = raw`[${MarkdownWordJoiners}]+`,\n\t// MarkdownIdentity = raw`(?:\\s|\\n|^)(${MarkdownWord}(?:${MarkdownWordJoiner}${MarkdownWord})*(?=\\b[\\s\\n]|$))`,\n\tMarkdownIdentity = raw`(?:\\s|\\n|^)(?:The (?=\\w)|)(${MarkdownWord}(?:${MarkdownWordJoiner}${MarkdownWord})*)`,\n}) => ({\n\tUnicodeIdentifier: new RegExp(UnicodeIdentifier, 'u'),\n\tMarkdownIdentityPrefixer: new RegExp(raw`^[${MarkdownWordPrefixes}]?`, 'u'),\n\tMarkdownIdentityJoiner: new RegExp(raw`[${MarkdownWordJoiners}]+`, 'ug'),\n\tMarkdownIdentityWord: new RegExp(MarkdownWord, 'u'),\n\tMarkdownIdentity: new RegExp(MarkdownIdentity, 'u'),\n\t// MarkdownIdentitySeparators: new RegExp(raw`[${MarkdownWordPrefixes}${MarkdownWordJoiners}]+`, 'ug')\n}))(entities.es);\n","﻿//@ts-check\n/// <reference path=\"../types.d.ts\" />\n\nimport * as entities from '../../entities.js';\nimport {styling} from '../../components.js';\nimport {content} from '../content.js';\nimport * as defaults from '../defaults.js';\n\n/** @param {Fragment} fragment @param {Record<string, boolean>} [flags] */\nexport const normalizeRenderedFragment = (fragment, flags) => {\n\tflags = {\n\t\tDOM_MUTATIONS: fragment.markoutContentFlags.DOM_MUTATIONS = defaults.flags.DOM_MUTATIONS,\n\t\tBREAK_NORMALIZATION: fragment.markoutContentFlags.BREAK_NORMALIZATION = defaults.flags.BREAK_NORMALIZATION,\n\t\tHEADING_NORMALIZATION: fragment.markoutContentFlags.HEADING_NORMALIZATION = defaults.flags.HEADING_NORMALIZATION,\n\t\tPARAGRAPH_NORMALIZATION: fragment.markoutContentFlags.PARAGRAPH_NORMALIZATION = defaults.flags\n\t\t\t.PARAGRAPH_NORMALIZATION,\n\t\tBLOCK_PARAGRAPH_NORMALIZATION: fragment.markoutContentFlags.BLOCK_PARAGRAPH_NORMALIZATION = defaults.flags\n\t\t\t.BLOCK_PARAGRAPH_NORMALIZATION,\n\t\tLIST_PARAGRAPH_NORMALIZATION: fragment.markoutContentFlags.LIST_PARAGRAPH_NORMALIZATION = defaults.flags\n\t\t\t.LIST_PARAGRAPH_NORMALIZATION,\n\t\tCHECKLIST_NORMALIZATION: fragment.markoutContentFlags.CHECKLIST_NORMALIZATION = defaults.flags\n\t\t\t.CHECKLIST_NORMALIZATION,\n\t\tBLOCKQUOTE_NORMALIZATION: fragment.markoutContentFlags.BLOCKQUOTE_NORMALIZATION = defaults.flags\n\t\t\t.BLOCKQUOTE_NORMALIZATION,\n\t\tBLOCKQUOTE_HEADING_NORMALIZATION: fragment.markoutContentFlags.BLOCKQUOTE_HEADING_NORMALIZATION = defaults.flags\n\t\t\t.BLOCKQUOTE_HEADING_NORMALIZATION,\n\t\tTOKEN_FLATTENING: fragment.markoutContentFlags.TOKEN_FLATTENING = defaults.flags.TOKEN_FLATTENING,\n\t\tDECLARATIVE_STYLING: fragment.markoutContentFlags.DECLARATIVE_STYLING = defaults.flags.DECLARATIVE_STYLING,\n\t\tSOURCE_TEXT_RENDERING: fragment.markoutContentFlags.SOURCE_TEXT_RENDERING = defaults.flags.SOURCE_TEXT_RENDERING,\n\t\tASSET_REMAPPING: fragment.markoutContentFlags.ASSET_REMAPPING = defaults.flags.ASSET_REMAPPING,\n\t\tASSET_INITIALIZATION: fragment.markoutContentFlags.ASSET_INITIALIZATION = defaults.flags.ASSET_INITIALIZATION,\n\t} = {\n\t\t...defaults.flags,\n\t\t...(fragment.markoutContentFlags || (fragment.markoutContentFlags = {})),\n\t\t...flags,\n\t};\n\n\tflags.DOM_MUTATIONS !== false &&\n\t\t((flags.BREAK_NORMALIZATION === true || flags.DOM_MUTATIONS === true) &&\n\t\t\tcontent.normalizeBreaksInFragment(fragment),\n\t\t(flags.HEADING_NORMALIZATION === true || flags.DOM_MUTATIONS === true) &&\n\t\t\tcontent.normalizeHeadingsInFragment(fragment),\n\t\t(flags.PARAGRAPH_NORMALIZATION === true || flags.DOM_MUTATIONS === true) &&\n\t\t\tcontent.normalizeParagraphsInFragment(fragment),\n\t\t(flags.BLOCKQUOTE_NORMALIZATION === true || flags.DOM_MUTATIONS === true) &&\n\t\t\tcontent.normalizeBlockquotesInFragment(fragment),\n\t\t(flags.CHECKLIST_NORMALIZATION === true || flags.DOM_MUTATIONS === true) &&\n\t\t\tcontent.normalizeChecklistsInFragment(fragment),\n\t\t(flags.DECLARATIVE_STYLING === true || flags.DOM_MUTATIONS === true) &&\n\t\t\tcontent.normalizeDeclarativeStylingInFragment(fragment));\n\n\t(flags.TOKEN_FLATTENING === true || (flags.TOKEN_FLATTENING !== false && flags.DOM_MUTATIONS !== false)) &&\n\t\t//@ts-ignore\n\t\tcontent.flattenTokensInFragment(fragment);\n\n\t//@ts-ignore\n\tcontent.renderURLExpansionLinksInFragment(fragment);\n};\n\n/** @param {Fragment} fragment */\nexport const normalizeBreaksInFragment = fragment => {\n\tfor (const br of fragment.querySelectorAll('br')) {\n\t\tconst {previousSibling, nextSibling, parentElement} = br;\n\t\t(!previousSibling ||\n\t\t\tpreviousSibling.nodeName !== 'SPAN' ||\n\t\t\t!nextSibling ||\n\t\t\tnextSibling.nodeName !== 'SPAN' ||\n\t\t\t(parentElement && !/^(?:CODE|PRE|LI)$/.test(parentElement.nodeName))) &&\n\t\t\tbr.remove();\n\t}\n};\n\ncontent.matchers.HeadingNumber = /^[1-9]\\d*\\.$|/;\n\n/** @param {Fragment} fragment */\nexport const normalizeHeadingsInFragment = fragment => {\n\tconst {MarkdownIdentity: Identity, MarkdownIdentityPrefixer: Prefixer, MarkdownIdentityJoiner: Joiner} = entities;\n\tconst {headings = (fragment.headings = {}), TEXT_NODE} = fragment;\n\n\tfor (const subheading of /** @type {Iterable<Heading>} */ (fragment.querySelectorAll(\n\t\tcontent.selectors.SubheadingsInFragment,\n\t))) {\n\t\tconst previousElementSibling = subheading.previousElementSibling;\n\t\tconst previousSibling = subheading.previousSibling;\n\t\tif (!previousElementSibling || previousSibling !== previousElementSibling) continue;\n\t\t// console.log({subheading, previousElementSibling, previousSibling});\n\t\tif (previousElementSibling && previousElementSibling.nodeName === 'HGROUP') {\n\t\t\tpreviousElementSibling.appendChild(subheading);\n\t\t} else if (previousElementSibling) {\n\t\t\tconst hgroup = document.createElement('hgroup');\n\t\t\tpreviousElementSibling.before(hgroup);\n\t\t\thgroup.appendChild(previousElementSibling);\n\t\t\thgroup.appendChild(subheading);\n\t\t}\n\t}\n\n\tfor (const heading of /** @type {Iterable<Heading>} */ (fragment.querySelectorAll(\n\t\tcontent.selectors.HeadingsInFragment,\n\t))) {\n\t\tconst level = parseFloat(heading.nodeName[1]);\n\t\tconst textSpan = heading.querySelector('span[token-type]');\n\t\tconst textNode =\n\t\t\t(textSpan && textSpan.firstChild && textSpan.firstChild.nodeType === TEXT_NODE && textSpan.firstChild) ||\n\t\t\tundefined;\n\n\t\tconst number =\n\t\t\ttextNode &&\n\t\t\theading.matches('hgroup > *') &&\n\t\t\tparseFloat(content.matchers.HeadingNumber.exec(textSpan.textContent)[0]);\n\n\t\t// Assuming all hgroup headings are either intentional or\n\t\t//   implied from markout notation, we want to pull out\n\t\t//   numbering into a data attribute\n\t\tnumber > 0 && ((heading.dataset.headingNumber = number), textNode.remove());\n\n\t\t// We're limit anchoring from H1 thru H3\n\t\t// if (parseFloat(heading.nodeName[1]) > 3) continue;\n\n\t\tconst [, identity] = Identity.exec(heading.textContent) || '';\n\t\tif (!identity) continue;\n\t\t/** @type {Anchor} */\n\t\tconst anchor = document.createElement('a');\n\t\tanchor.id = identity\n\t\t\t.replace(Prefixer, '')\n\t\t\t.replace(Joiner, '-')\n\t\t\t.toLowerCase();\n\t\tanchor.append(...heading.childNodes);\n\t\t// anchor.tabIndex = -1;\n\t\tanchor.heading = heading.anchor = {anchor, identity, heading, level, number};\n\t\theading.appendChild(anchor);\n\n\t\tconst nav = anchor.querySelector('nav:last-child');\n\t\tnav && heading.appendChild(nav);\n\n\t\t// Unique mappings are prioritized by heading level\n\t\t(anchor.id in headings && headings[anchor.id].level > level) || (headings[anchor.id] = heading.anchor);\n\t}\n};\n\n// const content.matchers.BlockParts = /^(?:(\\w+(?: \\w+)*)(:| - | — |)|)(.*)$/u;\ncontent.matchers.BlockParts = /^[*_]*?(?:(\\*{1,2}|_{1,2}|)(\\w+(?: \\w+)*)\\1(: | - | — |)|)(.*)$|/u;\n\n/** @param {Fragment} fragment */\ncontent.normalizeBlockquotesInFragment = fragment => {\n\t/** @type {BlockQuote} */\n\tlet previousBlockquote;\n\t/** @type {BlockQuote} */\n\tlet nextBlockquote;\n\t/** @type {NodeLike | ElementLike} */\n\tlet node;\n\t/** @type {NodeLike | ElementLike} */\n\tlet previousNode;\n\t/** @type {RangeLike} */\n\tlet range;\n\tlet heading, delimiter, headingSeparator, body;\n\tconst {COMMENT_NODE, TEXT_NODE, ELEMENT_NODE} = fragment;\n\n\tfor (const blockquote of /** @type {Iterable<BlockQuote>} */ (fragment.querySelectorAll('blockquote:not(:empty)'))) {\n\t\tnode = blockquote.querySelector(content.selectors.BlockHeadingNodesInFragment);\n\n\t\tnode == null ||\n\t\t\t(body = blockquote.textContent.trim()) === '' ||\n\t\t\t([, delimiter = '', heading = '', headingSeparator = '', body = ''] = content.matchers.BlockParts.exec(body));\n\n\t\t// console.log(`%o — ${delimiter}%s${delimiter}${headingSeparator}${body}`, {blockquote, node}, node.textContent);\n\n\t\tbody === '' || (blockquote.blockBody = body);\n\n\t\tif (node != null && heading) {\n\t\t\tblockquote.blockHeadingNode = /** @type {HTMLSpanElement} */ (node);\n\t\t\tblockquote.dataset.blockHeading = blockquote.blockHeading = heading;\n\t\t\tblockquote.dataset.blockHeadingSeparator = blockquote.blockHeadingSeparator = headingSeparator;\n\t\t\tif ((fragment.markoutContentFlags || defaults).BLOCKQUOTE_HEADING_NORMALIZATION === true) {\n\t\t\t\tnode.slot = 'block-heading';\n\t\t\t\trange = document.createRange();\n\t\t\t\trange.setStartAfter(node);\n\t\t\t\tpreviousNode = node;\n\n\t\t\t\tdo {\n\t\t\t\t\trange.setEndAfter((node = node.nextSibling));\n\t\t\t\t} while (!(range.text = range.toString()).startsWith(headingSeparator));\n\n\t\t\t\tif (range.text !== headingSeparator) {\n\t\t\t\t\tconsole.log(\n\t\t\t\t\t\t`%o — [%s][%s][${body}]`,\n\t\t\t\t\t\t{blockquote, range, contents: range.contents},\n\t\t\t\t\t\tpreviousNode.textContent,\n\t\t\t\t\t\trange.toString(),\n\t\t\t\t\t);\n\t\t\t\t} else {\n\t\t\t\t\tnode = document.createElement('span');\n\t\t\t\t\tnode.textContent = headingSeparator;\n\t\t\t\t\tnode.slot = 'block-heading-separator';\n\t\t\t\t\trange.deleteContents();\n\t\t\t\t\tpreviousNode.after(node);\n\t\t\t\t\tpreviousNode.parentElement.attachShadow({\n\t\t\t\t\t\tmode: 'open',\n\t\t\t\t\t}).innerHTML =\n\t\t\t\t\t\t//\n\t\t\t\t\t\t/* html */ `\n\t\t\t\t\t\t\t<style>:host {padding: 0.5em;}</style>\n\t\t\t\t\t\t\t<div style=\"display: grid; grid-template-columns: min-content auto; grid-gap: 1em;\">\n\t\t\t\t\t\t\t\t<div>\n\t\t\t\t\t\t\t\t\t<slot name=\"block-heading\"></slot>\n\t\t\t\t\t\t\t\t\t<slot name=\"block-heading-separator\" hidden></slot>\n\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t<div><slot></slot></div>\n\t\t\t\t\t\t\t</div>`;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\n\t// TODO: Figure out why we need all this…\n\tfor (const lastBlockquote of /** @type {Iterable<BlockQuote>} */ (fragment.querySelectorAll(\n\t\t':not(blockquote)[blockquote-level]+blockquote[blockquote-level]',\n\t))) {\n\t\tnextBlockquote = lastBlockquote;\n\t\tpreviousBlockquote = previousNode = undefined;\n\t\tlastBlockquote.blockquoteLevel = parseFloat(lastBlockquote.getAttribute('blockquote-level'));\n\n\t\tnode = lastBlockquote.previousSibling;\n\n\t\tif (\n\t\t\t!(lastBlockquote.blockquoteLevel > 0) ||\n\t\t\t!(\n\t\t\t\tlastBlockquote.previousElementSibling === node ||\n\t\t\t\tnode.nodeType === COMMENT_NODE ||\n\t\t\t\tnode.textContent.trim() === ''\n\t\t\t)\n\t\t) {\n\t\t\tcontent.normalizeBlockquotesInFragment.log({node, lastBlockquote, nextBlockquote, previousBlockquote});\n\t\t\tcontinue;\n\t\t}\n\n\t\twhile (\n\t\t\tnode != null &&\n\t\t\t(node.nodeName !== 'BLOCKQUOTE' || !(previousBlockquote = /** @type {BlockQuote } */ (node)))\n\t\t) {\n\t\t\tnode.blockquoteLevel =\n\t\t\t\tnode.nodeType === ELEMENT_NODE\n\t\t\t\t\t? parseFloat(node.getAttribute('blockquote-level'))\n\t\t\t\t\t: nextBlockquote.blockquoteLevel;\n\t\t\tpreviousNode = node.previousSibling;\n\t\t\tif (node.blockquoteLevel === nextBlockquote.blockquoteLevel) {\n\t\t\t} else if (node.blockquoteLevel > nextBlockquote.blockquoteLevel) {\n\t\t\t\tpreviousBlockquote = nextBlockquote;\n\t\t\t\tnextBlockquote = /** @type {BlockQuote } */ (document.createElement('blockquote'));\n\t\t\t\tnextBlockquote.setAttribute('blockquote-level', (nextBlockquote.blockquoteLevel = node.blockquoteLevel));\n\t\t\t\tpreviousBlockquote.prepend(nextBlockquote);\n\t\t\t} else if (node.blockquoteLevel < nextBlockquote.blockquoteLevel) {\n\t\t\t\tif (node.blockquoteLevel < lastBlockquote.blockquoteLevel) {\n\t\t\t\t\t// TODO: Is it safer to coerce or superseede?!\n\t\t\t\t\tnode.blockquoteLevel = lastBlockquote.blockquoteLevel;\n\t\t\t\t}\n\t\t\t\twhile (\n\t\t\t\t\tnextBlockquote.blockquoteLevel >= lastBlockquote.blockquoteLevel &&\n\t\t\t\t\tnode.blockquoteLevel < nextBlockquote.blockquoteLevel &&\n\t\t\t\t\tnextBlockquote.parentElement.blockquoteLevel < nextBlockquote.blockquoteLevel\n\t\t\t\t) {\n\t\t\t\t\tnextBlockquote = nextBlockquote.parentElement;\n\t\t\t\t}\n\t\t\t}\n\t\t\tnextBlockquote.prepend(node);\n\t\t\tnode = previousNode;\n\t\t}\n\n\t\tif (lastBlockquote.previousSibling === previousNode && previousBlockquote === previousNode) {\n\t\t\tif (\n\t\t\t\t('blockquoteLevel' in previousBlockquote\n\t\t\t\t\t? previousBlockquote.blockquoteLevel\n\t\t\t\t\t: (previousBlockquote.blockquoteLevel = parseFloat(previousBlockquote.getAttribute('blockquote-level')))) > 0\n\t\t\t) {\n\t\t\t\t// TODO: Is it safer to coerce or superseede?!\n\t\t\t\tif (previousBlockquote.blockquoteLevel < lastBlockquote.blockquoteLevel) continue;\n\n\t\t\t\tif (previousBlockquote.blockquoteLevel === lastBlockquote.blockquoteLevel) {\n\t\t\t\t\tpreviousBlockquote.childElementCount === 1 && previousBlockquote.firstElementChild.nodeName === 'DETAILS'\n\t\t\t\t\t\t? previousBlockquote.firstElementChild.append(...lastBlockquote.childNodes)\n\t\t\t\t\t\t: previousBlockquote.append(...lastBlockquote.childNodes);\n\t\t\t\t\tlastBlockquote.remove();\n\t\t\t\t}\n\t\t\t} else if (!previousBlockquote.hasAttribute('blockquote-level')) {\n\t\t\t\tpreviousBlockquote.setAttribute(\n\t\t\t\t\t'blockquote-level',\n\t\t\t\t\t`${(previousBlockquote.blockquoteLevel = lastBlockquote.blockquoteLevel)}`,\n\t\t\t\t);\n\t\t\t\t// TODO: Figure out if we can merge!\n\t\t\t}\n\t\t}\n\t}\n};\n\n/** @param {{node: Node | Element, lastBlockquote: HTMLQuoteElement, nextBlockquote?: HTMLQuoteElement,  previousBlockquote?:HTMLQuoteElement} } nodes */\ncontent.normalizeBlockquotesInFragment.log = nodes => {\n\tconst format = [];\n\tconst values = [];\n\tfor (const name of ['node', 'lastBlockquote', 'nextBlockquote', 'previousBlockquote']) {\n\t\tconst node = nodes[name];\n\t\tif (node == null || typeof node !== 'object') continue;\n\t\tformat.push('%s [%d] — %O');\n\t\tvalues.push(name, node.blockquoteLevel || (node.getAttribute && node.getAttribute('blockquote-level')), node);\n\t}\n\tformat.length && console.log(format.join('\\n'), ...values);\n};\n\ncontent.symbols.NormalizedChecklists = Symbol('NormalizedChecklists');\n\n/** @param {Fragment} fragment */\nexport const normalizeChecklistsInFragment = fragment => {\n\tconst seen =\n\t\tfragment[content.symbols.NormalizedChecklists] || (fragment[content.symbols.NormalizedChecklists] = new WeakSet());\n\n\tfor (const checklist of fragment.querySelectorAll(\n\t\t'li[type=checkbox]:not([checked]):not([indeterminate]) li[type=checkbox]:not([checked])',\n\t)) {\n\t\tlet parentChecklist = checklist;\n\t\t// console.log({checklist, parentChecklist});\n\t\twhile ((parentChecklist = parentChecklist.parentElement.closest('li[type=checkbox]'))) {\n\t\t\tseen.has(parentChecklist) ||\n\t\t\t\t(seen.add(parentChecklist),\n\t\t\t\tparentChecklist.querySelector(':scope li[type=checkbox]:not([checked]):not([indeterminate])')\n\t\t\t\t\t? parentChecklist.querySelector(':scope  li[type=checkbox][checked]')\n\t\t\t\t\t\t? (parentChecklist.removeAttribute('checked'), parentChecklist.setAttribute('indeterminate', ''))\n\t\t\t\t\t\t: (parentChecklist.removeAttribute('checked'), parentChecklist.removeAttribute('indeterminate'))\n\t\t\t\t\t: !parentChecklist.querySelector(':scope li[type=checkbox][checked]') ||\n\t\t\t\t\t  (parentChecklist.removeAttribute('indeterminate'), parentChecklist.setAttribute('checked', '')));\n\n\t\t\t// if (parentChecklist.hasAttribute('checked') || parentChecklist.hasAttribute('indeterminate')) break;\n\t\t\t// parentChecklist.setAttribute('indeterminate', '');\n\t\t}\n\t}\n};\n\ncontent.normalizeParagraphsInBlock = block => {\n\tlet element, node, nodes, paragraph, text;\n\tnode = block.firstChild;\n\tif (node == null) return;\n\telement = block.firstElementChild;\n\t// while (element != null && element.matches('span,code,kbd,tt,small,em,strong,b,i,a,q,wbr,br,slot')) {\n\twhile (element != null && !element.matches('hr,pre,p,blockquote,table,div')) {\n\t\telement = element.nextElementSibling;\n\t}\n\twhile (node !== element) {\n\t\t(nodes || (nodes = [])).push(node);\n\t\tnode = node.nextSibling;\n\t}\n\tif (nodes) {\n\t\tparagraph = document.createElement('p');\n\t\tparagraph.append(...nodes);\n\t\ttext = paragraph.textContent;\n\t\t// console.log({element, node, nodes, paragraph, text});\n\t\ttext && text.trim() && block.prepend(paragraph);\n\t}\n};\n\n/** @param {Fragment} fragment */\nexport const normalizeParagraphsInFragment = fragment => {\n\tif ((fragment.markoutContentFlags || defaults).BLOCK_PARAGRAPH_NORMALIZATION)\n\t\tfor (const block of fragment.querySelectorAll('li:not(:empty), blockquote:not(:empty)'))\n\t\t\tcontent.normalizeParagraphsInBlock(block);\n\tif ((fragment.markoutContentFlags || defaults).LIST_PARAGRAPH_NORMALIZATION)\n\t\tfor (const list of fragment.querySelectorAll(\n\t\t\t'li > p:first-child:last-child > ol:last-child, li > p:first-child:last-child > ul:last-child',\n\t\t))\n\t\t\tlist.parentElement.after(list);\n\n\tfor (const empty of fragment.querySelectorAll('p:empty')) empty.remove();\n};\n\n/** @param {Fragment} fragment */\nexport const normalizeDeclarativeStylingInFragment = fragment => {\n\tstyling.apply.toFragment(fragment);\n};\n\ncontent.normalizeRenderedFragment = normalizeRenderedFragment;\ncontent.normalizeBreaksInFragment = normalizeBreaksInFragment;\ncontent.normalizeHeadingsInFragment = normalizeHeadingsInFragment;\ncontent.normalizeChecklistsInFragment = normalizeChecklistsInFragment;\ncontent.normalizeParagraphsInFragment = normalizeParagraphsInFragment;\ncontent.normalizeDeclarativeStylingInFragment = normalizeDeclarativeStylingInFragment;\n\ncontent.selectors.HeadingsInFragment =\n\t'h1:not([id]):not(:empty),h2:not([id]):not(:empty),h3:not([id]):not(:empty),h4:not([id]):not(:empty),h5:not([id]):not(:empty),h6:not([id]):not(:empty)';\ncontent.selectors.SubheadingsInFragment = 'h1+h2, h2+h3, h3+h4, h4+h5, h5+h6';\ncontent.selectors.BlockHeadingNodesInFragment = ['i:first-child > b', 'b:first-child > i', 'b', 'i']\n\t.flatMap(selector => [\n\t\t`:scope > ${(selector = `${selector}:first-child:not(:empty)`)}`,\n\t\t`p:first-child > ${selector}`,\n\t])\n\t.join(',');\n\n/** @typedef {import('../types').Fragment} Fragment */\n/** @typedef {import('../types').Fragment.Heading} Heading */\n/** @typedef {import('../types').Fragment.Headings} Headings */\n/** @typedef {import('../types').Fragment.Anchor} Anchor */\n/** @typedef {import('../types').Fragment.BlockQuote} BlockQuote */\n/** @typedef {Node & {[name: string]: any}} NodeLike */\n/** @typedef {Element & {[name: string]: any}} ElementLike */\n/** @typedef {Range & {[name: string]: any}} RangeLike */\n","﻿//@ts-check\n/// <reference path=\"../types.d.ts\" />\n\nimport * as renderer from '../../renderer.js';\n\nimport '../markup.js';\nimport {content} from '../content.js';\n\n/** @param {string} sourceText @returns {Fragment}*/\nexport const createRenderedFragment = sourceText => {\n\t/** @type {Fragment} */\n\tlet fragment, normalizedText, tokens, renderedText;\n\n\tcontent.createRenderedFragment.template ||\n\t\t(content.createRenderedFragment.template = document.createElement('template'));\n\n\tcontent.createRenderedFragment.template.innerHTML = renderedText = renderer.render(\n\t\t(tokens = renderer.tokenize((normalizedText = renderer.normalize(sourceText)))),\n\t);\n\n\t//@ts-ignore\n\tfragment = content.createRenderedFragment.template.content.cloneNode(true);\n\tfragment.fragment = fragment;\n\tfragment.sourceText = sourceText;\n\tfragment.normalizedText = normalizedText;\n\tfragment.tokens = tokens;\n\tfragment.renderedText = renderedText;\n\n\treturn fragment;\n};\n\n/** @type {HTMLTemplateElement} */\ncreateRenderedFragment.template = undefined;\n\n/** @param {Fragment} fragment */\nexport const renderURLExpansionLinksInFragment = fragment => {\n\tfor (const span of fragment.querySelectorAll('span[href]')) {\n\t\tif (span.closest('a')) continue;\n\t\tconst anchor = document.createElement('a');\n\t\tanchor.href = span.getAttribute('href');\n\t\tspan.before(anchor);\n\t\tanchor.append(...span.childNodes);\n\t\tspan.remove();\n\t}\n};\n\n/** @param {Fragment} fragment */\nexport const renderSourceTextsInFragment = fragment => {\n\tconst promises = [];\n\n\tfor (const element of fragment.querySelectorAll(`[${content.MarkupAttributeMap.SourceType}]:not(:empty)`))\n\t\tpromises.push(\n\t\t\tcontent.renderSourceText({\n\t\t\t\telement,\n\t\t\t\tsourceType:\n\t\t\t\t\telement.getAttribute(content.MarkupAttributeMap.MarkupMode) ||\n\t\t\t\t\telement.getAttribute(content.MarkupAttributeMap.SourceType),\n\t\t\t\tsourceText: element.textContent,\n\t\t\t}),\n\t\t);\n\n\treturn promises.length ? Promise.all(promises) : Promise.resolve();\n};\n\ncontent.createRenderedFragment = createRenderedFragment;\ncontent.renderURLExpansionLinksInFragment = renderURLExpansionLinksInFragment;\ncontent.renderSourceTextsInFragment = renderSourceTextsInFragment;\n\n/** @typedef {import('../types').Fragment} Fragment */\n","﻿//@ts-check\n/// <reference path=\"./types.d.ts\" />\n\nimport {Enum} from '../helpers.js';\n\nimport './markup.js';\nimport './dom/normalizer.js';\nimport './dom/renderer.js';\n// export * from './dom/normalizer.js';\n// export * from './dom/renderer.js';\nimport {content} from './content.js';\n\n/** @param {Fragment} fragment */\nexport const populateAssetsInFragment = fragment => {\n\tif (!fragment || fragment.assets) return;\n\tfragment.assets = [];\n\n\tfor (const link of /** @type {Iterable<Link>} */ (fragment.querySelectorAll(content.AssetNodeSelector))) {\n\t\tif (link.nodeName === 'SCRIPT') {\n\t\t\tif (link.type === 'module') {\n\t\t\t\t(fragment.assets.modules || (fragment.assets.modules = [])).push(/** @type {HTMLScriptElement} */ (link));\n\t\t\t} else if (!link.type || link.type.trim().toLowerCase() === 'text/javascript') {\n\t\t\t\t(fragment.assets.scripts || (fragment.assets.scripts = [])).push(/** @type {HTMLScriptElement} */ (link));\n\t\t\t}\n\t\t} else if (link.nodeName === 'STYLE') {\n\t\t\tif (!link.type || link.type.trim().toLowerCase() === 'text/css') {\n\t\t\t\t(fragment.assets.stylesheets || (fragment.assets.stylesheets = [])).push(\n\t\t\t\t\t/** @type {HTMLStyleElement} */ (link),\n\t\t\t\t);\n\t\t\t}\n\t\t} else {\n\t\t\t/** @type {Links} */ (\n\t\t\t\tfragment.assets[content.AssetNodeMap[link.nodeName]] ||\n\t\t\t\t//@ts-ignore\n\t\t\t\t(fragment.assets[content.AssetNodeMap[link.nodeName]] = [])\n\t\t\t).push(link);\n\t\t}\n\t\tfragment.assets.push(link);\n\t}\n\n\treturn fragment;\n};\n\n/** @param {Fragment} fragment */\nexport const flattenTokensInFragment = fragment => {\n\tfor (const token of fragment.querySelectorAll('span[token-type],tt[token-type]')) {\n\t\ttoken.nodeName === 'TT' || token.before(...token.childNodes);\n\t\ttoken.remove();\n\t}\n};\n\nexport const AssetNodeMap = Enum({\n\tIMG: 'images',\n\tSOURCE: 'sources',\n\tVIDEO: 'videos',\n});\n\nexport const AssetNodeSelector = ['script', 'style', ...Object.keys(AssetNodeMap)]\n\t.map(tag => `${tag.toUpperCase()}[src]:not([slot]),${tag.toUpperCase()}[srcset]:not([slot])`)\n\t.join(',');\n\ncontent.AssetNodeSelector = AssetNodeSelector;\ncontent.AssetNodeMap = AssetNodeMap;\ncontent.populateAssetsInFragment = populateAssetsInFragment;\ncontent.flattenTokensInFragment = flattenTokensInFragment;\n\n/** @typedef {import('./types').Fragment} Fragment */\n/** @typedef {import('./types').Fragment.Link} Link */\n/** @typedef {import('./types').Fragment.Links} Links */\n","﻿//@ts-check\nimport dynamicImport from '/browser/dynamic-import.js';\nimport '../lib/content/dom.js';\nimport {content} from '../lib/content.js';\nimport {Component} from '../lib/components.js';\n\nexport class MarkoutContent extends Component {\n\t/** @type {{[name: string]: boolean | undefined}} */\n\tstatic get flags() {\n\t\t//@ts-ignore\n\t\tconst flags = Object.create(super.flags || null);\n\n\t\tfor (const flag in content.defaults.flags) {\n\t\t\tconst value = import.meta[`markout-content-${flag.replace(/-/g, '_').toLowerCase}`];\n\t\t\tvalue === undefined || (flags[flag] = value);\n\t\t}\n\n\t\treturn super.set('flags', Object.freeze(flags));\n\t}\n\n\tstatic get template() {\n\t\treturn super.set(\n\t\t\t'template',\n\t\t\tthis.html/* html */ `\n\t\t\t\t<slot inert hidden style=\"display:none;\"></slot>\n\t\t\t\t<slot id=\"styles\" name=\"styles\"></slot>\n\t\t\t\t<div id=\"links\"></div>\n\t\t\t\t<div id=\"wrapper\">\n\t\t\t\t\t<slot id=\"content\" class=\"markout-content\" name=\"content\"></slot>\n\t\t\t\t</div>\n\t\t\t`,\n\t\t);\n\t}\n\n\tstatic get shadowRoot() {\n\t\treturn super.set('shadowRoot', /** @type {ShadowRootInit} */ ({mode: 'closed'}));\n\t}\n\n\tstatic get assets() {\n\t\treturn super.set('assets', new this.Assets({base: new URL('../', import.meta.url)}, 'style:styles/markout.css'));\n\t}\n\n\tstatic get styles() {\n\t\treturn super.set(\n\t\t\t'styles',\n\t\t\tthis.css/* css */ `\n\t\t\t\t@import \"${MarkoutContent.assets['style:styles/markout.css']}\";\n\n\t\t\t\t:host {\n\t\t\t\t\tpadding: 1rem 2rem;\n\t\t\t\t\twhite-space: normal;\n\t\t\t\t}\n\n\t\t\t\t.hide {\n\t\t\t\t\topacity: 0;\n\t\t\t\t\tdisplay: block;\n\t\t\t\t}\n\n\t\t\t\t#wrapper {\n\t\t\t\t\t/* will-change: transition;\n\t\t\t\t\ttransition: 0 / 125ms, opacity 250ms / 250ms; */\n\t\t\t\t}\n\n\t\t\t\t#wrapper.hide {\n\t\t\t\t\twill-change: transition;\n\t\t\t\t\ttransition: 0 / 125ms, opacity 250ms / 250ms;\n\t\t\t\t}\n\n\t\t\t\t/* #content:not(.hide) { */\n\t\t\t\t\t/* will-change: transition; */\n\t\t\t\t\t/* transition: opacity 250ms / 250ms; */\n\t\t\t\t/* } */\n\n\t\t\t\t#content tt.opener:first-child,\n\t\t\t\t#content tt.closer:last-child {\n\t\t\t\t\tdisplay: none !important;\n\t\t\t\t}\n\n\t\t\t\t#content .markout-content {\n\t\t\t\t\tborder: 0.075rem solid #9992;\n\t\t\t\t\tborder-radius: 3px;\n\t\t\t\t\tposition: relative;\n\t\t\t\t\tpadding: 1em 2em;\n\t\t\t\t\tpadding-inline-start: 2em;\n\t\t\t\t\tdisplay: block;\n\t\t\t\t\tcontain: style;\n\t\t\t\t}\n\n\t\t\t\t@media only screen and (max-width: 45rem) {\n\t\t\t\t\t:host {\n\t\t\t\t\t\tfont-size: 85%;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t`,\n\t\t);\n\t}\n\n\tconstructor() {\n\t\tsuper();\n\n\t\tthis.flags = new.target.flags;\n\t\t//@ts-ignore\n\t\tthis.name = `${this.tagName}-${++new.target.instance}`.toLocaleLowerCase();\n\n\t\t/** @type {HTMLSlotElement} */ const slot = this['::'];\n\t\tslot &&\n\t\t\tslot.addEventListener(\n\t\t\t\t'slotchange',\n\t\t\t\t/** @param {Event} event */ event => this.isConnected && this.updateMarkoutContent(slot),\n\t\t\t\t{\n\t\t\t\t\tpassive: true,\n\t\t\t\t},\n\t\t\t);\n\t}\n\n\tconnectedCallback() {\n\t\t'renderedText' in this || (this.rendered = this.renderMarkoutContent(this.sourceText));\n\t\tsuper.connectedCallback();\n\t}\n\n\tscrollToAnchor(anchor) {\n\t\t/** @type {HTMLAnchorElement} */\n\t\tlet target;\n\t\t//@ts-ignore\n\t\tconst {'::content': contentSlot} = this;\n\t\tif (typeof anchor === 'string' && (anchor = anchor.trim()) !== '') {\n\t\t\tanchor = anchor.toLocaleLowerCase().replace(/^the-/, '');\n\t\t\t(target = contentSlot.querySelector(`a[id=\"${anchor}\"]`))\n\t\t\t\t? target.scrollIntoView({behavior: 'smooth', block: 'start', inline: 'nearest'})\n\t\t\t\t: console.warn('scrollIntoView: %o', {anchor, target});\n\t\t}\n\t}\n\n\tasync updateMarkoutContent(slot = this['::']) {\n\t\tconst assignedNodes = slot && slot.assignedNodes();\n\t\tif (assignedNodes.length) {\n\t\t\treturn (this.rendered = this.renderMarkoutContent(this.sourceText || ''));\n\t\t}\n\t}\n\n\t/** @param {string} [sourceText] */\n\tasync renderMarkoutContent(sourceText) {\n\t\t/** @type {HTMLSlotElement} */\n\t\tlet contentSlot;\n\t\t/** @type {HTMLSlotElement} */\n\t\tlet wrapperSlot;\n\t\t/** @type {string} */\n\t\tlet sourceURL;\n\n\t\t//@ts-ignore\n\t\t({'::content': contentSlot, '#wrapper': wrapperSlot, sourceURL} = this);\n\n\t\targuments.length || (sourceText = this.sourceText);\n\n\t\tif (sourceText === this['(markout source)']) return;\n\t\tthis['(markout fragment)'] = undefined;\n\t\tif (!sourceText) return void (this['(markout source)'] = contentSlot.textContent = '');\n\n\t\twrapperSlot.style.transition = contentSlot.style.transition = '0s';\n\t\tcontentSlot.hidden = wrapperSlot.hidden = true;\n\t\tcontentSlot.classList.add('hide');\n\t\twrapperSlot.classList.add('hide');\n\n\t\tawait new Promise(resolve => requestAnimationFrame(resolve));\n\n\t\twrapperSlot.style.transition = contentSlot.style.transition = '';\n\t\twrapperSlot.classList.remove('hide');\n\t\twrapperSlot.hidden = false;\n\n\t\tcontentSlot.textContent = '';\n\t\tconst fragment = (this['(markout fragment)'] = await this.appendMarkoutContent(sourceText, contentSlot, sourceURL));\n\n\t\tthis['(markout source)'] = sourceText;\n\n\t\tconst timeout = new Promise(resolve => setTimeout(resolve, 150));\n\n\t\tfragment.assets !== null &&\n\t\t\ttypeof fragment.assets === 'object' &&\n\t\t\t(fragment.markoutContentFlags.ASSET_INITIALIZATION === true ||\n\t\t\t\t(fragment.markoutContentFlags.ASSET_INITIALIZATION !== false &&\n\t\t\t\t\tfragment.markoutContentFlags.DOM_MUTATIONS !== false)) &&\n\t\t\t(fragment.assets.modules && fragment.assets.modules.forEach(this.instantiateLinkedModule, this),\n\t\t\tfragment.assets.scripts && fragment.assets.scripts.forEach(this.instantiateLinkedScript, this));\n\n\t\tawait Promise.race([MarkoutContent.assets['style:styles/markout.css'], timeout]);\n\n\t\tawait timeout;\n\n\t\tcontentSlot.classList.remove('hide');\n\t\tcontentSlot.hidden = false;\n\n\t\t//@ts-ignore\n\t\tif (this.rewriteAnchors) {\n\t\t\tconst anchors = contentSlot.querySelectorAll('a[href]');\n\t\t\t//@ts-ignore\n\t\t\tanchors && this.rewriteAnchors([...anchors]);\n\t\t}\n\t}\n\n\t/** @param {string} sourceText @param {HTMLSlotElement} contentSlot @param {string} baseURL */\n\tasync appendMarkoutContent(sourceText = this.sourceText, contentSlot = this['::content'], baseURL = this.baseURI) {\n\t\tconst {fragment} = content.createRenderedFragment(sourceText);\n\n\t\tfragment.baseURL = baseURL;\n\n\t\tcontent.normalizeRenderedFragment(fragment, MarkoutContent.flags);\n\n\t\tcontentSlot.appendChild(\n\t\t\tawait (fragment.instantiated || (fragment.instantiated = this.instantiateMarkoutFragment(fragment))),\n\t\t);\n\n\t\treturn {slot: contentSlot, sourceText, fragment, ...fragment};\n\t}\n\n\tasync instantiateMarkoutFragment(fragment) {\n\t\tif (fragment.instantiated) return fragment.instantiated;\n\n\t\tconst promises = [];\n\n\t\t(fragment.markoutContentFlags.SOURCE_TEXT_RENDERING === true ||\n\t\t\t(fragment.markoutContentFlags.SOURCE_TEXT_RENDERING !== false &&\n\t\t\t\tfragment.markoutContentFlags.DOM_MUTATIONS !== false)) &&\n\t\t\tpromises.push(content.renderSourceTextsInFragment(fragment));\n\n\t\t(fragment.markoutContentFlags.ASSET_REMAPPING === true ||\n\t\t\t(fragment.markoutContentFlags.ASSET_REMAPPING !== false &&\n\t\t\t\tfragment.markoutContentFlags.DOM_MUTATIONS !== false)) &&\n\t\t\tpromises.push(this.linkMarkoutFragment(fragment));\n\n\t\tpromises.length && (await Promise.all(promises));\n\n\t\treturn fragment;\n\t}\n\n\tasync linkMarkoutFragment(fragment) {\n\t\tif (fragment.instantiated) return fragment.instantiated;\n\n\t\tif (fragment.markoutContentFlags.ASSET_REMAPPING) {\n\t\t\tcontent.populateAssetsInFragment(fragment);\n\n\t\t\tconst baseURL = fragment.baseURL || fragment.baseURI;\n\n\t\t\tfor (const link of fragment.assets) {\n\t\t\t\tconst {base: baseAttribute, [link.nodeName === 'SOURCE' ? 'srcset' : 'src']: srcAttribute} = link.attributes;\n\t\t\t\tconst base = baseAttribute ? baseAttribute.value : baseURL;\n\t\t\t\tbaseAttribute && link.removeAttribute('base');\n\t\t\t\tlink.setAttribute('link-base', base);\n\t\t\t\tif (srcAttribute) {\n\t\t\t\t\tconst attribute = srcAttribute.name;\n\t\t\t\t\tconst [href] = srcAttribute.value.split(/\\s/, 1);\n\t\t\t\t\tlink.setAttribute(`link-${attribute}`, href);\n\t\t\t\t\tlink.setAttribute(attribute, (link[attribute] = new URL(href, base)));\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tfragment.assets.stylesheets &&\n\t\t\t\tfragment.assets.stylesheets.length &&\n\t\t\t\tfragment.prepend(\n\t\t\t\t\tObject.assign(document.createElement('style'), {\n\t\t\t\t\t\ttextContent: fragment.assets.stylesheets\n\t\t\t\t\t\t\t.map(stylesheet => (stylesheet.remove(), `@import \"${stylesheet.src}\";`))\n\t\t\t\t\t\t\t.join('\\n'),\n\t\t\t\t\t}),\n\t\t\t\t);\n\t\t}\n\n\t\treturn fragment;\n\t}\n\n\t/** @param {HTMLScriptElement} module */\n\tinstantiateLinkedModule(module) {\n\t\tif (module['(markout host)'] === this || !module.isConnected) return;\n\t\tmodule['(markout host)'] = this;\n\t\tmodule.before(document.createComment(module.outerHTML.trim()));\n\t\tmodule.remove();\n\t\tmodule.src.startsWith(location.origin) &&\n\t\t\t/\\?.*?\\bdev\\b/i.test(location.href) &&\n\t\t\t(module.src = module.src.replace(\n\t\t\t\t/(\\?[^#]*|)(#.*|)$/,\n\t\t\t\t(m, query, hash) => `${query ? `${query}&` : '?'}dev${hash}`,\n\t\t\t));\n\t\t// console.log(module, module.src);\n\t\tdynamicImport(module.src);\n\t}\n\n\t/** @param {HTMLScriptElement} script */\n\tinstantiateLinkedScript(script) {\n\t\tif (script['(markout host)'] === this || !script.isConnected) return;\n\t\tif (script.parentElement.nodeName === 'OUTPUT') {\n\t\t\tscript['(markout host)'] = this;\n\t\t\tthis.evaluateMarkoutScript(script);\n\t\t}\n\t}\n\n\tasync evaluateMarkoutScript(script) {\n\t\tconst {src} = script;\n\t\tconst sourceText = await (await fetch(src)).text();\n\t\tawait new Promise(requestAnimationFrame);\n\t\tdocument['--currentScript--'] = script;\n\t\t(1, eval)(`${sourceText}\\ndelete document['--currentScript--']`);\n\t}\n\n\t/// Properties\n\tget sourceText() {\n\t\t//@ts-ignore\n\t\tconst {childNodes, firstElementChild, renderedText} = this;\n\t\tif (renderedText || renderedText === '') return renderedText;\n\n\t\tif (firstElementChild && firstElementChild.nodeName === 'TEMPLATE') return firstElementChild.innerHTML.trim() || '';\n\n\t\tif (childNodes.length) {\n\t\t\tconst innerHTML = this.innerHTML;\n\t\t\tconst [, indent] = /^\\n?([ \\t*]*|)/.exec(innerHTML);\n\t\t\treturn indent ? innerHTML.replace(new RegExp(`^${indent}`, 'mg'), '') : innerHTML.trim() || '';\n\t\t}\n\t}\n\n\tset sourceText(sourceText) {\n\t\tthis.rendered = this.renderMarkoutContent(sourceText);\n\t}\n\n\t/// Constants\n\n\tstatic get MARKUP_SYNTAX_ATTRIBUTE() {\n\t\treturn super.set('MARKUP_SYNTAX_ATTRIBUTE', content.MarkupAttributeMap.MarkupSyntax);\n\t}\n\tstatic get SOURCE_TYPE_ATTRIBUTE() {\n\t\treturn super.set('SOURCE_TYPE_ATTRIBUTE', content.MarkupAttributeMap.SourceType);\n\t}\n\tstatic get MARKUP_MODE_ATTRIBUTE() {\n\t\treturn super.set('MARKUP_MODE_ATTRIBUTE', content.MarkupAttributeMap.MarkupMode);\n\t}\n}\n\ntry {\n\tcustomElements.define('markout-content', MarkoutContent);\n} catch (exception) {\n\tconsole.warn(exception);\n}\n","﻿// const RewritableURL = /^(\\.*(?=\\/)[^?#\\n]*\\/)(?:([^/?#\\n]+?)(?:(\\.[a-z]+)|)|)(\\?[^#]+|)(#.*|)$|/i;\nconst RewritableURL = /^(\\.*(?=\\/)[^?#\\n]*\\/|)(?:(?:([^/?#\\n]+?)(?:(\\.[a-z]+)|)|)|)(\\?[^#]+|)(#.*|)$|/i;\n\nconst {dir, dirxml, group, groupCollapsed, groupEnd, log} = console;\n\nexport const rewriteAnchors = (\n\tanchors,\n\t{sourceURL, baseURL, search, rootNode = document, debugging = import.meta['debug:hashout:anchor-rewrite']},\n) => {\n\tdebugging && groupCollapsed('%O ‹anchors› ', rootNode);\n\n\tfor (const anchor of anchors) {\n\t\tconst [matched, parent, name, extension = '.md', query = '', hash = ''] = RewritableURL.exec(\n\t\t\tanchor.getAttribute('href'),\n\t\t);\n\n\t\tdebugging && log({matched, parent, name, extension, query, hash});\n\n\t\tif (parent) {\n\t\t\tconst pathname = `${parent}${name ? `${name}${extension}` : ''}`;\n\n\t\t\tconst href =\n\t\t\t\tname && extension.toLowerCase() === '.md'\n\t\t\t\t\t? `${baseURL}${search}#${new URL(pathname, sourceURL).pathname}${hash}`\n\t\t\t\t\t: new URL(`${pathname}${query || ((!hash && search) || '')}${hash}`, sourceURL);\n\t\t\tanchor.href = href;\n\t\t} else if (hash) {\n\t\t\tanchor.href = `${location}${matched}`;\n\t\t} else {\n\t\t\tanchor.target || (anchor.target = '_blank');\n\t\t}\n\n\t\tif (debugging && hash) debugger;\n\t\tdebugging && dirxml(anchor);\n\t}\n\n\tdebugging && groupEnd();\n};\n\n/// Debugging\nimport {debugging} from '/markout/lib/helpers.js';\n\ndebugging('hashout', import.meta, [\n\t// import.meta.url.includes('/markout/lib/') ||\n\ttypeof location === 'object' && /[?&]debug(?=[&#]|=[^&]*\\bhashout|$)\\b/.test(location.search),\n\t'anchor-rewrite',\n]);\n","﻿import '../elements/markout-content.js';\nimport * as hashout from './hashout.js';\n\n(async () => {\n\tawait customElements.whenDefined('markout-content');\n\n\t/** @type {import('../elements/markout-content.js')['MarkoutContent']} */\n\tconst MarkoutContent = customElements.get('markout-content');\n\n\t/**\n\t * @typedef {HTMLAnchorElement} Anchor\n\t */\n\tconst ExtendedMarkoutContent = class extends MarkoutContent {\n\t\tasync load(src) {\n\t\t\tlet error;\n\t\t\targuments.length || (src = this.getAttribute('src'));\n\t\t\tif (!src) return;\n\t\t\tconst url = new URL(src, this.baseURI);\n\t\t\tconst response = await fetch(url);\n\t\t\tif (!response.ok) throw Error(`Failed to fetch ${url}`);\n\t\t\tconst text = await response.text();\n\t\t\tthis.sourceURL = url;\n\t\t\tthis.sourceText = text || '';\n\t\t}\n\n\t\t/**\n\t\t * @typedef {Array<Anchor>} Anchors\n\t\t * @param {Anchors} anchors\n\t\t */\n\t\trewriteAnchors(...anchors) {\n\t\t\tconst debugging = import.meta['debug:markout:anchor-rewrite'];\n\t\t\tconst rootNode = this;\n\t\t\tconst {sourceURL, baseURL = `/markout/`} = rootNode;\n\t\t\tconst search = location.search || '';\n\t\t\thashout.rewriteAnchors(anchors.flat(), {debugging, sourceURL, baseURL, search, rootNode});\n\t\t}\n\t};\n\n\tconst sections = document.body.querySelectorAll('markout-content[src]');\n\tif (sections) {\n\t\tconst {load, rewriteAnchors} = ExtendedMarkoutContent.prototype;\n\t\tfor (const section of sections) {\n\t\t\tsection.load || ((section.load = load), section.rewriteAnchors || (section.rewriteAnchors = rewriteAnchors)),\n\t\t\t\tsection.load().catch(exception => (section.sourceText = `<pre>${exception}</pre>`));\n\t\t}\n\t}\n})();\n\n/// Debugging\nimport {debugging} from '/markout/lib/helpers.js';\n\n// console.log(import.meta.url, /[?&]debug\\b/.test(import.meta.url));\n\ndebugging('markout', import.meta, [\n\t// import.meta.url.includes('/markout/lib/') ||\n\t// /[?](?:.*[&]|)debug\\b/.test(import.meta.url) ||\n\t// (typeof location === 'object' && /[?&]debug(?=[&#]|=[^&]*\\bmarkout|$)\\b/.test(location.search)),\n\t/[?&]debug\\b/.test(import.meta.url) || /[?&]debug\\b/.test(location.search),\n\t'anchor-rewrite',\n]);\n"],"names":["entities","flags","defaults.flags.DOM_MUTATIONS","defaults.flags.BREAK_NORMALIZATION","defaults.flags.HEADING_NORMALIZATION","defaults.flags\n\t\t\t.PARAGRAPH_NORMALIZATION","defaults.flags\n\t\t\t.BLOCK_PARAGRAPH_NORMALIZATION","defaults.flags\n\t\t\t.LIST_PARAGRAPH_NORMALIZATION","defaults.flags\n\t\t\t.CHECKLIST_NORMALIZATION","defaults.flags\n\t\t\t.BLOCKQUOTE_NORMALIZATION","defaults.flags\n\t\t\t.BLOCKQUOTE_HEADING_NORMALIZATION","defaults.flags.TOKEN_FLATTENING","defaults.flags.DECLARATIVE_STYLING","defaults.flags.SOURCE_TEXT_RENDERING","defaults.flags.ASSET_REMAPPING","defaults.flags.ASSET_INITIALIZATION","defaults.flags","renderer.render","renderer.tokenize","renderer.normalize","hashout.rewriteAnchors"],"mappings":";;;;;AAAgB,eAAe,aAAa,CAAC,SAAS,EAAE,QAAQ,EAAE;CACjE,IAAI,EAAE,SAAS,IAAI,aAAa,CAAC,EAAE;EAClC,MAAM,CAAC,MAAM,EAAE,MAAM,EAAE,gBAAgB,EAAE,MAAM,EAAE,yBAAyB,EAAE,cAAc,CAAC,GAAG,MAAM,CAAC;EACrG,IAAI,IAAI,CAAC;EACT,MAAM,OAAO,GAAG,MAAM,CAAC,CAAC,SAAS,EAAE,QAAQ,KAAK,CAAC,EAAE,IAAI,GAAG,CAAC,SAAS,EAAE,QAAQ,IAAI,IAAI,IAAI,QAAQ,CAAC,CAAC,CAAC,CAAC,CAAC;EACvG,MAAM,UAAU,GAAG,CAAC,OAAO,CAAC,CAAC;EAC7B,IAAI;GACH,UAAU,CAAC,MAAM,GAAG,MAAM,CAAC,CAAC,CAAC,EAAE,IAAI,EAAE,CAAC,kBAAkB,CAAC,CAAC,CAAC,CAAC;GAC5D,UAAU,CAAC,MAAM,GAAG,MAAM,CAAC,MAAM;IAChC,MAAM,KAAK,CAAC,CAAC,6CAA6C,CAAC,CAAC,CAAC;IAC7D,CAAC,CAAC;GACH,CAAC,OAAO,SAAS,EAAE;GACnB,MAAM,OAAO,GAAG,MAAM,CAAC,yBAAyB,CAAC,IAAI,CAAC,IAAI,CAAC,CAAC,CAAC;GAC7D,MAAM,aAAa,GAAG,QAAQ,CAAC,aAAa,CAAC,IAAI,CAAC,QAAQ,CAAC,CAAC;GAC5D,MAAM,aAAa,GAAG,QAAQ,CAAC,WAAW,CAAC,IAAI,CAAC,QAAQ,CAAC,IAAI,CAAC,CAAC;GAC/D,MAAM,OAAO,GAAG,EAAE,CAAC;GACnB,MAAM,SAAS,GAAG,EAAE,CAAC;GACrB,MAAM,OAAO,GAAG,IAAI,OAAO,EAAE,CAAC;GAC9B,MAAM,KAAK,GAAG,IAAI,KAAK,CAAC,MAAM,CAAC,MAAM,CAAC,IAAI,CAAC,CAAC,EAAE;IAC7C,GAAG,EAAE,CAAC,MAAM,EAAE,QAAQ,EAAE,QAAQ,KAAK;KACpC,MAAM,MAAM,GAAG,OAAO,CAAC,GAAG,CAAC,QAAQ,CAAC,CAAC;KACrC,IAAI,MAAM,IAAI,OAAO,CAAC,MAAM,CAAC,cAAc,CAAC,QAAQ,EAAE,IAAI,CAAC,CAAC;MAC3D,OAAO,MAAM,CAAC,gBAAgB,CAAC,QAAQ,EAAE,CAAC,GAAG,MAAM,CAAC,OAAO,CAAC,EAAE,GAAG,OAAO,CAAC,QAAQ,CAAC,CAAC,CAAC,CAAC,CAAC,QAAQ,CAAC,CAAC;KACjG;IACD,CAAC,CAAC;GACH,MAAM,MAAM,GAAG,MAAM,MAAM,CAAC;IAC3B,WAAW,CAAC,GAAG,EAAE;KAChB,MAAM,CAAC,IAAI,GAAG,MAAM,CAAC,IAAI,EAAE,MAAM,GAAG,MAAM,CAAC,MAAM,CAAC,GAAG,GAAG,CAAC,MAAM,CAAC;KAChE,IAAI,CAAC,GAAG,GAAG,GAAG,CAAC;KACf,IAAI,CAAC,SAAS,GAAG,MAAM,CAAC,KAAK,EAAE;MAC9B,CAAC,MAAM,CAAC,WAAW,GAAG,CAAC,KAAK,EAAE,CAAC,OAAO,EAAE,GAAG,CAAC,CAAC,CAAC,CAAC;MAC/C,CAAC,CAAC;KACH,IAAI,CAAC,MAAM,GAAG,IAAI,CAAC,GAAG,GAAG,IAAI,CAAC,MAAM,GAAG,CAAC,6BAA6B,CAAC,IAAI,IAAI,CAAC,MAAM,GAAG,MAAM,CAAC,IAAI,CAAC,GAAG,EAAE,CAAC;KAC1G,IAAI,CAAC,OAAO,GAAG,MAAM,CAAC,IAAI,CAAC,CAAC;KAC5B,MAAM,CAAC,IAAI,CAAC,CAAC;KACb;IACD,OAAO,IAAI,CAAC,GAAG,EAAE,MAAM,EAAE,MAAM,EAAE;KAChC,OAAO,CAAC,4BAA4B,EAAE,GAAG,CAAC,wBAAwB,EAAE,MAAM,CAAC,mBAAmB,EAAE,GAAG,CAAC,GAAG,EAAE,MAAM,CAAC,EAAE,CAAC,CAAC;KACpH;IACD,OAAO,MAAM,CAAC,CAAC,GAAG,EAAE,MAAM,EAAE,WAAW,EAAE,SAAS,EAAE,WAAW,GAAG,WAAW,EAAE,IAAI,GAAG,QAAQ,CAAC,EAAE;KAChG,IAAI,OAAO,CAAC;KACZ,MAAM,MAAM,GAAG,MAAM,CAAC,aAAa,CAAC,QAAQ,CAAC,EAAE,CAAC,IAAI,EAAE,QAAQ,EAAE,WAAW,EAAE,WAAW,CAAC,CAAC,CAAC;KAC3F,MAAM,OAAO,GAAG,IAAI,OAAO;MAC1B,OAAO,KAAK,OAAO,GAAG,UAAU,EAAE,MAAM,CAAC,OAAO,GAAG,SAAS,CAAC,GAAG,CAAC,GAAG,OAAO,GAAG,IAAI,EAAE,CAAC,IAAI,EAAE,SAAS,CAAC,CAAC,CAAC;MACvG,CAAC,IAAI,CAAC,KAAK,IAAI;MACf,SAAS,CAAC,GAAG,CAAC,GAAG,MAAM,CAAC,OAAO,GAAG,KAAK,YAAY,CAAC,OAAO,CAAC,CAAC;MAC7D,IAAI,CAAC,KAAK,IAAI,KAAK,CAAC,IAAI,KAAK,MAAM,EAAE,OAAO,SAAS,CAAC;MACtD,MAAM,KAAK,CAAC,CAAC,gBAAgB,EAAE,GAAG,CAAC,CAAC,CAAC,CAAC,CAAC;MACvC,CAAC,CAAC;KACH,aAAa,CAAC,MAAM,CAAC,CAAC,MAAM,EAAE,CAAC;KAC/B,OAAO,OAAO,CAAC;KACf;IACD,CAAC;;GAEF,MAAM,CAAC,MAAM,CAAC,MAAM,CAAC,SAAS,CAAC,CAAC,WAAW,CAAC,CAAC;;GAE7C,UAAU,CAAC,MAAM,GAAG,MAAM,CAAC,GAAG,IAAI;IACjC,MAAM,CAAC,CAAC,GAAG,GAAG,MAAM,IAAI,OAAO,CAAC,GAAG,CAAC,GAAG,IAAI,MAAM,CAAC,OAAO,CAAC,GAAG,CAAC,CAAC,CAAC,CAAC,GAAG,OAAO,CAAC;IAC5E,OAAO,MAAM,CAAC,OAAO,CAAC;IACtB,CAAC,CAAC;;GAEH,UAAU,CAAC,MAAM,GAAG,MAAM,CAAC,CAAC,GAAG,EAAE,MAAM,KAAK;IAC3C,MAAM,CAAC,CAAC,GAAG,GAAG,MAAM,CAAC,GAAG,OAAO,CAAC;IAChC,IAAI,CAAC,MAAM,IAAI,OAAO,MAAM,KAAK,UAAU,IAAI,CAAC,EAAE,MAAM,CAAC,CAAC,KAAK,MAAM,CAAC,MAAM,IAAI,OAAO,CAAC,GAAG,CAAC,MAAM,CAAC,SAAS,CAAC;KAC5G,MAAM,KAAK,CAAC,CAAC,6CAA6C,CAAC,CAAC,CAAC;IAC9D,OAAO,CAAC,GAAG,CAAC,MAAM,CAAC,SAAS,EAAE,MAAM,CAAC,CAAC;IACtC,SAAS,CAAC,GAAG,CAAC,IAAI,SAAS,CAAC,GAAG,CAAC,EAAE,CAAC;IACnC,CAAC,CAAC;GACH;;EAED,gBAAgB,CAAC,aAAa,EAAE;GAC/B,GAAG,yBAAyB,CAAC,MAAM,CAAC,UAAU,CAAC,CAAC;GAChD,IAAI,EAAE,CAAC,GAAG,EAAE,MAAM,IAAI,EAAE,GAAG,EAAE,KAAK,KAAK,IAAI,GAAG,CAAC,EAAE,IAAI,GAAG,CAAC,KAAK,CAAC,CAAC,CAAC,CAAC,CAAC;GACnE,CAAC,CAAC;EACH;CACD,OAAO,aAAa,CAAC,MAAM,CAAC,aAAa,CAAC,OAAO,CAAC,SAAS,EAAE,QAAQ,CAAC,CAAC,CAAC;CACxE;;AC1EM,MAAM;CACZ,iBAAiB;CACjB,wBAAwB;CACxB,sBAAsB;CACtB,oBAAoB;CACpB,gBAAgB;CAChB,GAAG,CAAC,CAAC;CACL,GAAG,GAAG,MAAM,CAAC,GAAG;CAChB,eAAe;CACf,cAAc;CACd,sBAAsB,GAAG,eAAe,CAAC,KAAK,CAAC,CAAC,CAAC;CACjD,qBAAqB,GAAG,cAAc,CAAC,KAAK,CAAC,CAAC,CAAC;CAC/C,iBAAiB,GAAG,GAAG,CAAC,GAAG,EAAE,sBAAsB,CAAC,IAAI,EAAE,qBAAqB,CAAC,EAAE,CAAC;CACnF,oBAAoB,GAAG,GAAG,CAAC,EAAE,CAAC;CAC9B,kBAAkB,GAAG,GAAG,CAAC,CAAC,EAAE,oBAAoB,CAAC,EAAE,CAAC;CACpD,YAAY,GAAG,GAAG,CAAC,EAAE,kBAAkB,CAAC,EAAE,iBAAiB,CAAC,CAAC;CAC7D,mBAAmB,GAAG,GAAG,CAAC,sCAAsC,CAAC;CACjE,kBAAkB,GAAG,GAAG,CAAC,CAAC,EAAE,mBAAmB,CAAC,EAAE,CAAC;;CAEnD,gBAAgB,GAAG,GAAG,CAAC,2BAA2B,EAAE,YAAY,CAAC,GAAG,EAAE,kBAAkB,CAAC,EAAE,YAAY,CAAC,GAAG,CAAC;CAC5G,MAAM;CACN,iBAAiB,EAAE,IAAI,MAAM,CAAC,iBAAiB,EAAE,GAAG,CAAC;CACrD,wBAAwB,EAAE,IAAI,MAAM,CAAC,GAAG,CAAC,EAAE,EAAE,oBAAoB,CAAC,EAAE,CAAC,EAAE,GAAG,CAAC;CAC3E,sBAAsB,EAAE,IAAI,MAAM,CAAC,GAAG,CAAC,CAAC,EAAE,mBAAmB,CAAC,EAAE,CAAC,EAAE,IAAI,CAAC;CACxE,oBAAoB,EAAE,IAAI,MAAM,CAAC,YAAY,EAAE,GAAG,CAAC;CACnD,gBAAgB,EAAE,IAAI,MAAM,CAAC,gBAAgB,EAAE,GAAG,CAAC;;CAEnD,CAAC,EAAEA,UAAQ,CAAC,EAAE,CAAC,CAAC;;;;;;;;;;;AC7BhB;AACD,AAMA;;AAEA,AAAO,MAAM,yBAAyB,GAAG,CAAC,QAAQ,EAAEC,OAAK,KAAK;CAC7DA,OAAK,GAAG;EACP,aAAa,EAAE,QAAQ,CAAC,mBAAmB,CAAC,aAAa,GAAGC,aAA4B;EACxF,mBAAmB,EAAE,QAAQ,CAAC,mBAAmB,CAAC,mBAAmB,GAAGC,mBAAkC;EAC1G,qBAAqB,EAAE,QAAQ,CAAC,mBAAmB,CAAC,qBAAqB,GAAGC,qBAAoC;EAChH,uBAAuB,EAAE,QAAQ,CAAC,mBAAmB,CAAC,uBAAuB,GAAGC,uBACvD;EACzB,6BAA6B,EAAE,QAAQ,CAAC,mBAAmB,CAAC,6BAA6B,GAAGC,6BAC7D;EAC/B,4BAA4B,EAAE,QAAQ,CAAC,mBAAmB,CAAC,4BAA4B,GAAGC,4BAC5D;EAC9B,uBAAuB,EAAE,QAAQ,CAAC,mBAAmB,CAAC,uBAAuB,GAAGC,uBACvD;EACzB,wBAAwB,EAAE,QAAQ,CAAC,mBAAmB,CAAC,wBAAwB,GAAGC,wBACxD;EAC1B,gCAAgC,EAAE,QAAQ,CAAC,mBAAmB,CAAC,gCAAgC,GAAGC,gCAChE;EAClC,gBAAgB,EAAE,QAAQ,CAAC,mBAAmB,CAAC,gBAAgB,GAAGC,gBAA+B;EACjG,mBAAmB,EAAE,QAAQ,CAAC,mBAAmB,CAAC,mBAAmB,GAAGC,mBAAkC;EAC1G,qBAAqB,EAAE,QAAQ,CAAC,mBAAmB,CAAC,qBAAqB,GAAGC,qBAAoC;EAChH,eAAe,EAAE,QAAQ,CAAC,mBAAmB,CAAC,eAAe,GAAGC,eAA8B;EAC9F,oBAAoB,EAAE,QAAQ,CAAC,mBAAmB,CAAC,oBAAoB,GAAGC,oBAAmC;EAC7G,GAAG;EACH,GAAGC,KAAc;EACjB,IAAI,QAAQ,CAAC,mBAAmB,KAAK,QAAQ,CAAC,mBAAmB,GAAG,EAAE,CAAC,CAAC;EACxE,GAAGf,OAAK;EACR,CAAC;;CAEFA,OAAK,CAAC,aAAa,KAAK,KAAK;GAC3B,CAACA,OAAK,CAAC,mBAAmB,KAAK,IAAI,IAAIA,OAAK,CAAC,aAAa,KAAK,IAAI;GACnE,OAAO,CAAC,yBAAyB,CAAC,QAAQ,CAAC;EAC5C,CAACA,OAAK,CAAC,qBAAqB,KAAK,IAAI,IAAIA,OAAK,CAAC,aAAa,KAAK,IAAI;GACpE,OAAO,CAAC,2BAA2B,CAAC,QAAQ,CAAC;EAC9C,CAACA,OAAK,CAAC,uBAAuB,KAAK,IAAI,IAAIA,OAAK,CAAC,aAAa,KAAK,IAAI;GACtE,OAAO,CAAC,6BAA6B,CAAC,QAAQ,CAAC;EAChD,CAACA,OAAK,CAAC,wBAAwB,KAAK,IAAI,IAAIA,OAAK,CAAC,aAAa,KAAK,IAAI;GACvE,OAAO,CAAC,8BAA8B,CAAC,QAAQ,CAAC;EACjD,CAACA,OAAK,CAAC,uBAAuB,KAAK,IAAI,IAAIA,OAAK,CAAC,aAAa,KAAK,IAAI;GACtE,OAAO,CAAC,6BAA6B,CAAC,QAAQ,CAAC;EAChD,CAACA,OAAK,CAAC,mBAAmB,KAAK,IAAI,IAAIA,OAAK,CAAC,aAAa,KAAK,IAAI;GAClE,OAAO,CAAC,qCAAqC,CAAC,QAAQ,CAAC,CAAC,CAAC;;CAE3D,CAACA,OAAK,CAAC,gBAAgB,KAAK,IAAI,KAAKA,OAAK,CAAC,gBAAgB,KAAK,KAAK,IAAIA,OAAK,CAAC,aAAa,KAAK,KAAK,CAAC;;EAEtG,OAAO,CAAC,uBAAuB,CAAC,QAAQ,CAAC,CAAC;;;CAG3C,OAAO,CAAC,iCAAiC,CAAC,QAAQ,CAAC,CAAC;CACpD,CAAC;;;AAGF,AAAO,MAAM,yBAAyB,GAAG,QAAQ,IAAI;CACpD,KAAK,MAAM,EAAE,IAAI,QAAQ,CAAC,gBAAgB,CAAC,IAAI,CAAC,EAAE;EACjD,MAAM,CAAC,eAAe,EAAE,WAAW,EAAE,aAAa,CAAC,GAAG,EAAE,CAAC;EACzD,CAAC,CAAC,eAAe;GAChB,eAAe,CAAC,QAAQ,KAAK,MAAM;GACnC,CAAC,WAAW;GACZ,WAAW,CAAC,QAAQ,KAAK,MAAM;IAC9B,aAAa,IAAI,CAAC,mBAAmB,CAAC,IAAI,CAAC,aAAa,CAAC,QAAQ,CAAC,CAAC;GACpE,EAAE,CAAC,MAAM,EAAE,CAAC;EACb;CACD,CAAC;;AAEF,OAAO,CAAC,QAAQ,CAAC,aAAa,GAAG,eAAe,CAAC;;;AAGjD,AAAO,MAAM,2BAA2B,GAAG,QAAQ,IAAI;CACtD,MAAM,CAAC,gBAAgB,EAAE,QAAQ,EAAE,wBAAwB,EAAE,QAAQ,EAAE,sBAAsB,EAAE,MAAM,CAAC,GAAG,QAAQ,CAAC;CAClH,MAAM,CAAC,QAAQ,IAAI,QAAQ,CAAC,QAAQ,GAAG,EAAE,CAAC,EAAE,SAAS,CAAC,GAAG,QAAQ,CAAC;;CAElE,KAAK,MAAM,UAAU,sCAAsC,QAAQ,CAAC,gBAAgB;EACnF,OAAO,CAAC,SAAS,CAAC,qBAAqB;EACvC,GAAG;EACH,MAAM,sBAAsB,GAAG,UAAU,CAAC,sBAAsB,CAAC;EACjE,MAAM,eAAe,GAAG,UAAU,CAAC,eAAe,CAAC;EACnD,IAAI,CAAC,sBAAsB,IAAI,eAAe,KAAK,sBAAsB,EAAE,SAAS;;EAEpF,IAAI,sBAAsB,IAAI,sBAAsB,CAAC,QAAQ,KAAK,QAAQ,EAAE;GAC3E,sBAAsB,CAAC,WAAW,CAAC,UAAU,CAAC,CAAC;GAC/C,MAAM,IAAI,sBAAsB,EAAE;GAClC,MAAM,MAAM,GAAG,QAAQ,CAAC,aAAa,CAAC,QAAQ,CAAC,CAAC;GAChD,sBAAsB,CAAC,MAAM,CAAC,MAAM,CAAC,CAAC;GACtC,MAAM,CAAC,WAAW,CAAC,sBAAsB,CAAC,CAAC;GAC3C,MAAM,CAAC,WAAW,CAAC,UAAU,CAAC,CAAC;GAC/B;EACD;;CAED,KAAK,MAAM,OAAO,sCAAsC,QAAQ,CAAC,gBAAgB;EAChF,OAAO,CAAC,SAAS,CAAC,kBAAkB;EACpC,GAAG;EACH,MAAM,KAAK,GAAG,UAAU,CAAC,OAAO,CAAC,QAAQ,CAAC,CAAC,CAAC,CAAC,CAAC;EAC9C,MAAM,QAAQ,GAAG,OAAO,CAAC,aAAa,CAAC,kBAAkB,CAAC,CAAC;EAC3D,MAAM,QAAQ;GACb,CAAC,QAAQ,IAAI,QAAQ,CAAC,UAAU,IAAI,QAAQ,CAAC,UAAU,CAAC,QAAQ,KAAK,SAAS,IAAI,QAAQ,CAAC,UAAU;GACrG,SAAS,CAAC;;EAEX,MAAM,MAAM;GACX,QAAQ;GACR,OAAO,CAAC,OAAO,CAAC,YAAY,CAAC;GAC7B,UAAU,CAAC,OAAO,CAAC,QAAQ,CAAC,aAAa,CAAC,IAAI,CAAC,QAAQ,CAAC,WAAW,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC;;;;;EAK1E,MAAM,GAAG,CAAC,KAAK,CAAC,OAAO,CAAC,OAAO,CAAC,aAAa,GAAG,MAAM,GAAG,QAAQ,CAAC,MAAM,EAAE,CAAC,CAAC;;;;;EAK5E,MAAM,GAAG,QAAQ,CAAC,GAAG,QAAQ,CAAC,IAAI,CAAC,OAAO,CAAC,WAAW,CAAC,IAAI,EAAE,CAAC;EAC9D,IAAI,CAAC,QAAQ,EAAE,SAAS;;EAExB,MAAM,MAAM,GAAG,QAAQ,CAAC,aAAa,CAAC,GAAG,CAAC,CAAC;EAC3C,MAAM,CAAC,EAAE,GAAG,QAAQ;IAClB,OAAO,CAAC,QAAQ,EAAE,EAAE,CAAC;IACrB,OAAO,CAAC,MAAM,EAAE,GAAG,CAAC;IACpB,WAAW,EAAE,CAAC;EAChB,MAAM,CAAC,MAAM,CAAC,GAAG,OAAO,CAAC,UAAU,CAAC,CAAC;;EAErC,MAAM,CAAC,OAAO,GAAG,OAAO,CAAC,MAAM,GAAG,CAAC,MAAM,EAAE,QAAQ,EAAE,OAAO,EAAE,KAAK,EAAE,MAAM,CAAC,CAAC;EAC7E,OAAO,CAAC,WAAW,CAAC,MAAM,CAAC,CAAC;;EAE5B,MAAM,GAAG,GAAG,MAAM,CAAC,aAAa,CAAC,gBAAgB,CAAC,CAAC;EACnD,GAAG,IAAI,OAAO,CAAC,WAAW,CAAC,GAAG,CAAC,CAAC;;;EAGhC,CAAC,MAAM,CAAC,EAAE,IAAI,QAAQ,IAAI,QAAQ,CAAC,MAAM,CAAC,EAAE,CAAC,CAAC,KAAK,GAAG,KAAK,MAAM,QAAQ,CAAC,MAAM,CAAC,EAAE,CAAC,GAAG,OAAO,CAAC,MAAM,CAAC,CAAC;EACvG;CACD,CAAC;;;AAGF,OAAO,CAAC,QAAQ,CAAC,UAAU,GAAG,mEAAmE,CAAC;;;AAGlG,OAAO,CAAC,8BAA8B,GAAG,QAAQ,IAAI;;CAEpD,IAAI,kBAAkB,CAAC;;CAEvB,IAAI,cAAc,CAAC;;CAEnB,IAAI,IAAI,CAAC;;CAET,IAAI,YAAY,CAAC;;CAEjB,IAAI,KAAK,CAAC;CACV,IAAI,OAAO,EAAE,SAAS,EAAE,gBAAgB,EAAE,IAAI,CAAC;CAC/C,MAAM,CAAC,YAAY,EAAE,SAAS,EAAE,YAAY,CAAC,GAAG,QAAQ,CAAC;;CAEzD,KAAK,MAAM,UAAU,yCAAyC,QAAQ,CAAC,gBAAgB,CAAC,wBAAwB,CAAC,GAAG;EACnH,IAAI,GAAG,UAAU,CAAC,aAAa,CAAC,OAAO,CAAC,SAAS,CAAC,2BAA2B,CAAC,CAAC;;EAE/E,IAAI,IAAI,IAAI;GACX,CAAC,IAAI,GAAG,UAAU,CAAC,WAAW,CAAC,IAAI,EAAE,MAAM,EAAE;IAC5C,GAAG,SAAS,GAAG,EAAE,EAAE,OAAO,GAAG,EAAE,EAAE,gBAAgB,GAAG,EAAE,EAAE,IAAI,GAAG,EAAE,CAAC,GAAG,OAAO,CAAC,QAAQ,CAAC,UAAU,CAAC,IAAI,CAAC,IAAI,CAAC,CAAC,CAAC;;;;EAI/G,IAAI,KAAK,EAAE,KAAK,UAAU,CAAC,SAAS,GAAG,IAAI,CAAC,CAAC;;EAE7C,IAAI,IAAI,IAAI,IAAI,IAAI,OAAO,EAAE;GAC5B,UAAU,CAAC,gBAAgB,mCAAmC,IAAI,CAAC,CAAC;GACpE,UAAU,CAAC,OAAO,CAAC,YAAY,GAAG,UAAU,CAAC,YAAY,GAAG,OAAO,CAAC;GACpE,UAAU,CAAC,OAAO,CAAC,qBAAqB,GAAG,UAAU,CAAC,qBAAqB,GAAG,gBAAgB,CAAC;GAC/F,IAAI,CAAC,QAAQ,CAAC,mBAAmB,IAAI,QAAQ,EAAE,gCAAgC,KAAK,IAAI,EAAE;IACzF,IAAI,CAAC,IAAI,GAAG,eAAe,CAAC;IAC5B,KAAK,GAAG,QAAQ,CAAC,WAAW,EAAE,CAAC;IAC/B,KAAK,CAAC,aAAa,CAAC,IAAI,CAAC,CAAC;IAC1B,YAAY,GAAG,IAAI,CAAC;;IAEpB,GAAG;KACF,KAAK,CAAC,WAAW,EAAE,IAAI,GAAG,IAAI,CAAC,WAAW,EAAE,CAAC;KAC7C,QAAQ,CAAC,CAAC,KAAK,CAAC,IAAI,GAAG,KAAK,CAAC,QAAQ,EAAE,EAAE,UAAU,CAAC,gBAAgB,CAAC,EAAE;;IAExE,IAAI,KAAK,CAAC,IAAI,KAAK,gBAAgB,EAAE;KACpC,OAAO,CAAC,GAAG;MACV,CAAC,cAAc,EAAE,IAAI,CAAC,CAAC,CAAC;MACxB,CAAC,UAAU,EAAE,KAAK,EAAE,QAAQ,EAAE,KAAK,CAAC,QAAQ,CAAC;MAC7C,YAAY,CAAC,WAAW;MACxB,KAAK,CAAC,QAAQ,EAAE;MAChB,CAAC;KACF,MAAM;KACN,IAAI,GAAG,QAAQ,CAAC,aAAa,CAAC,MAAM,CAAC,CAAC;KACtC,IAAI,CAAC,WAAW,GAAG,gBAAgB,CAAC;KACpC,IAAI,CAAC,IAAI,GAAG,yBAAyB,CAAC;KACtC,KAAK,CAAC,cAAc,EAAE,CAAC;KACvB,YAAY,CAAC,KAAK,CAAC,IAAI,CAAC,CAAC;KACzB,YAAY,CAAC,aAAa,CAAC,YAAY,CAAC;MACvC,IAAI,EAAE,MAAM;MACZ,CAAC,CAAC,SAAS;;iBAEA,CAAC;;;;;;;;aAQL,CAAC,CAAC;KACV;IACD;GACD;EACD;;;CAGD,KAAK,MAAM,cAAc,yCAAyC,QAAQ,CAAC,gBAAgB;EAC1F,iEAAiE;EACjE,GAAG;EACH,cAAc,GAAG,cAAc,CAAC;EAChC,kBAAkB,GAAG,YAAY,GAAG,SAAS,CAAC;EAC9C,cAAc,CAAC,eAAe,GAAG,UAAU,CAAC,cAAc,CAAC,YAAY,CAAC,kBAAkB,CAAC,CAAC,CAAC;;EAE7F,IAAI,GAAG,cAAc,CAAC,eAAe,CAAC;;EAEtC;GACC,EAAE,cAAc,CAAC,eAAe,GAAG,CAAC,CAAC;GACrC;IACC,cAAc,CAAC,sBAAsB,KAAK,IAAI;IAC9C,IAAI,CAAC,QAAQ,KAAK,YAAY;IAC9B,IAAI,CAAC,WAAW,CAAC,IAAI,EAAE,KAAK,EAAE;IAC9B;IACA;GACD,OAAO,CAAC,8BAA8B,CAAC,GAAG,CAAC,CAAC,IAAI,EAAE,cAAc,EAAE,cAAc,EAAE,kBAAkB,CAAC,CAAC,CAAC;GACvG,SAAS;GACT;;EAED;GACC,IAAI,IAAI,IAAI;IACX,IAAI,CAAC,QAAQ,KAAK,YAAY,IAAI,EAAE,kBAAkB,+BAA+B,IAAI,CAAC,CAAC,CAAC;IAC5F;GACD,IAAI,CAAC,eAAe;IACnB,IAAI,CAAC,QAAQ,KAAK,YAAY;OAC3B,UAAU,CAAC,IAAI,CAAC,YAAY,CAAC,kBAAkB,CAAC,CAAC;OACjD,cAAc,CAAC,eAAe,CAAC;GACnC,YAAY,GAAG,IAAI,CAAC,eAAe,CAAC;GACpC,IAAI,IAAI,CAAC,eAAe,KAAK,cAAc,CAAC,eAAe,EAAE,CAC5D,MAAM,IAAI,IAAI,CAAC,eAAe,GAAG,cAAc,CAAC,eAAe,EAAE;IACjE,kBAAkB,GAAG,cAAc,CAAC;IACpC,cAAc,+BAA+B,QAAQ,CAAC,aAAa,CAAC,YAAY,CAAC,CAAC,CAAC;IACnF,cAAc,CAAC,YAAY,CAAC,kBAAkB,GAAG,cAAc,CAAC,eAAe,GAAG,IAAI,CAAC,eAAe,EAAE,CAAC;IACzG,kBAAkB,CAAC,OAAO,CAAC,cAAc,CAAC,CAAC;IAC3C,MAAM,IAAI,IAAI,CAAC,eAAe,GAAG,cAAc,CAAC,eAAe,EAAE;IACjE,IAAI,IAAI,CAAC,eAAe,GAAG,cAAc,CAAC,eAAe,EAAE;;KAE1D,IAAI,CAAC,eAAe,GAAG,cAAc,CAAC,eAAe,CAAC;KACtD;IACD;KACC,cAAc,CAAC,eAAe,IAAI,cAAc,CAAC,eAAe;KAChE,IAAI,CAAC,eAAe,GAAG,cAAc,CAAC,eAAe;KACrD,cAAc,CAAC,aAAa,CAAC,eAAe,GAAG,cAAc,CAAC,eAAe;MAC5E;KACD,cAAc,GAAG,cAAc,CAAC,aAAa,CAAC;KAC9C;IACD;GACD,cAAc,CAAC,OAAO,CAAC,IAAI,CAAC,CAAC;GAC7B,IAAI,GAAG,YAAY,CAAC;GACpB;;EAED,IAAI,cAAc,CAAC,eAAe,KAAK,YAAY,IAAI,kBAAkB,KAAK,YAAY,EAAE;GAC3F;IACC,CAAC,iBAAiB,IAAI,kBAAkB;OACrC,kBAAkB,CAAC,eAAe;QACjC,kBAAkB,CAAC,eAAe,GAAG,UAAU,CAAC,kBAAkB,CAAC,YAAY,CAAC,kBAAkB,CAAC,CAAC,CAAC,IAAI,CAAC;KAC7G;;IAED,IAAI,kBAAkB,CAAC,eAAe,GAAG,cAAc,CAAC,eAAe,EAAE,SAAS;;IAElF,IAAI,kBAAkB,CAAC,eAAe,KAAK,cAAc,CAAC,eAAe,EAAE;KAC1E,kBAAkB,CAAC,iBAAiB,KAAK,CAAC,IAAI,kBAAkB,CAAC,iBAAiB,CAAC,QAAQ,KAAK,SAAS;QACtG,kBAAkB,CAAC,iBAAiB,CAAC,MAAM,CAAC,GAAG,cAAc,CAAC,UAAU,CAAC;QACzE,kBAAkB,CAAC,MAAM,CAAC,GAAG,cAAc,CAAC,UAAU,CAAC,CAAC;KAC3D,cAAc,CAAC,MAAM,EAAE,CAAC;KACxB;IACD,MAAM,IAAI,CAAC,kBAAkB,CAAC,YAAY,CAAC,kBAAkB,CAAC,EAAE;IAChE,kBAAkB,CAAC,YAAY;KAC9B,kBAAkB;KAClB,CAAC,GAAG,kBAAkB,CAAC,eAAe,GAAG,cAAc,CAAC,eAAe,EAAE,CAAC;KAC1E,CAAC;;IAEF;GACD;EACD;CACD,CAAC;;;AAGF,OAAO,CAAC,8BAA8B,CAAC,GAAG,GAAG,KAAK,IAAI;CACrD,MAAM,MAAM,GAAG,EAAE,CAAC;CAClB,MAAM,MAAM,GAAG,EAAE,CAAC;CAClB,KAAK,MAAM,IAAI,IAAI,CAAC,MAAM,EAAE,gBAAgB,EAAE,gBAAgB,EAAE,oBAAoB,CAAC,EAAE;EACtF,MAAM,IAAI,GAAG,KAAK,CAAC,IAAI,CAAC,CAAC;EACzB,IAAI,IAAI,IAAI,IAAI,IAAI,OAAO,IAAI,KAAK,QAAQ,EAAE,SAAS;EACvD,MAAM,CAAC,IAAI,CAAC,cAAc,CAAC,CAAC;EAC5B,MAAM,CAAC,IAAI,CAAC,IAAI,EAAE,IAAI,CAAC,eAAe,KAAK,IAAI,CAAC,YAAY,IAAI,IAAI,CAAC,YAAY,CAAC,kBAAkB,CAAC,CAAC,EAAE,IAAI,CAAC,CAAC;EAC9G;CACD,MAAM,CAAC,MAAM,IAAI,OAAO,CAAC,GAAG,CAAC,MAAM,CAAC,IAAI,CAAC,IAAI,CAAC,EAAE,GAAG,MAAM,CAAC,CAAC;CAC3D,CAAC;;AAEF,OAAO,CAAC,OAAO,CAAC,oBAAoB,GAAG,MAAM,CAAC,sBAAsB,CAAC,CAAC;;;AAGtE,AAAO,MAAM,6BAA6B,GAAG,QAAQ,IAAI;CACxD,MAAM,IAAI;EACT,QAAQ,CAAC,OAAO,CAAC,OAAO,CAAC,oBAAoB,CAAC,KAAK,QAAQ,CAAC,OAAO,CAAC,OAAO,CAAC,oBAAoB,CAAC,GAAG,IAAI,OAAO,EAAE,CAAC,CAAC;;CAEpH,KAAK,MAAM,SAAS,IAAI,QAAQ,CAAC,gBAAgB;EAChD,wFAAwF;EACxF,EAAE;EACF,IAAI,eAAe,GAAG,SAAS,CAAC;;EAEhC,QAAQ,eAAe,GAAG,eAAe,CAAC,aAAa,CAAC,OAAO,CAAC,mBAAmB,CAAC,GAAG;GACtF,IAAI,CAAC,GAAG,CAAC,eAAe,CAAC;KACvB,IAAI,CAAC,GAAG,CAAC,eAAe,CAAC;IAC1B,eAAe,CAAC,aAAa,CAAC,8DAA8D,CAAC;OAC1F,eAAe,CAAC,aAAa,CAAC,oCAAoC,CAAC;SACjE,eAAe,CAAC,eAAe,CAAC,SAAS,CAAC,EAAE,eAAe,CAAC,YAAY,CAAC,eAAe,EAAE,EAAE,CAAC;SAC7F,eAAe,CAAC,eAAe,CAAC,SAAS,CAAC,EAAE,eAAe,CAAC,eAAe,CAAC,eAAe,CAAC,CAAC;OAC/F,CAAC,eAAe,CAAC,aAAa,CAAC,mCAAmC,CAAC;QAClE,eAAe,CAAC,eAAe,CAAC,eAAe,CAAC,EAAE,eAAe,CAAC,YAAY,CAAC,SAAS,EAAE,EAAE,CAAC,CAAC,CAAC,CAAC;;;;GAIrG;EACD;CACD,CAAC;;AAEF,OAAO,CAAC,0BAA0B,GAAG,KAAK,IAAI;CAC7C,IAAI,OAAO,EAAE,IAAI,EAAE,KAAK,EAAE,SAAS,EAAE,IAAI,CAAC;CAC1C,IAAI,GAAG,KAAK,CAAC,UAAU,CAAC;CACxB,IAAI,IAAI,IAAI,IAAI,EAAE,OAAO;CACzB,OAAO,GAAG,KAAK,CAAC,iBAAiB,CAAC;;CAElC,OAAO,OAAO,IAAI,IAAI,IAAI,CAAC,OAAO,CAAC,OAAO,CAAC,+BAA+B,CAAC,EAAE;EAC5E,OAAO,GAAG,OAAO,CAAC,kBAAkB,CAAC;EACrC;CACD,OAAO,IAAI,KAAK,OAAO,EAAE;EACxB,CAAC,KAAK,KAAK,KAAK,GAAG,EAAE,CAAC,EAAE,IAAI,CAAC,IAAI,CAAC,CAAC;EACnC,IAAI,GAAG,IAAI,CAAC,WAAW,CAAC;EACxB;CACD,IAAI,KAAK,EAAE;EACV,SAAS,GAAG,QAAQ,CAAC,aAAa,CAAC,GAAG,CAAC,CAAC;EACxC,SAAS,CAAC,MAAM,CAAC,GAAG,KAAK,CAAC,CAAC;EAC3B,IAAI,GAAG,SAAS,CAAC,WAAW,CAAC;;EAE7B,IAAI,IAAI,IAAI,CAAC,IAAI,EAAE,IAAI,KAAK,CAAC,OAAO,CAAC,SAAS,CAAC,CAAC;EAChD;CACD,CAAC;;;AAGF,AAAO,MAAM,6BAA6B,GAAG,QAAQ,IAAI;CACxD,IAAI,CAAC,QAAQ,CAAC,mBAAmB,IAAI,QAAQ,EAAE,6BAA6B;EAC3E,KAAK,MAAM,KAAK,IAAI,QAAQ,CAAC,gBAAgB,CAAC,wCAAwC,CAAC;GACtF,OAAO,CAAC,0BAA0B,CAAC,KAAK,CAAC,CAAC;CAC5C,IAAI,CAAC,QAAQ,CAAC,mBAAmB,IAAI,QAAQ,EAAE,4BAA4B;EAC1E,KAAK,MAAM,IAAI,IAAI,QAAQ,CAAC,gBAAgB;GAC3C,8FAA8F;GAC9F;GACA,IAAI,CAAC,aAAa,CAAC,KAAK,CAAC,IAAI,CAAC,CAAC;;CAEjC,KAAK,MAAM,KAAK,IAAI,QAAQ,CAAC,gBAAgB,CAAC,SAAS,CAAC,EAAE,KAAK,CAAC,MAAM,EAAE,CAAC;CACzE,CAAC;;;AAGF,AAAO,MAAM,qCAAqC,GAAG,QAAQ,IAAI;CAChE,OAAO,CAAC,KAAK,CAAC,UAAU,CAAC,QAAQ,CAAC,CAAC;CACnC,CAAC;;AAEF,OAAO,CAAC,yBAAyB,GAAG,yBAAyB,CAAC;AAC9D,OAAO,CAAC,yBAAyB,GAAG,yBAAyB,CAAC;AAC9D,OAAO,CAAC,2BAA2B,GAAG,2BAA2B,CAAC;AAClE,OAAO,CAAC,6BAA6B,GAAG,6BAA6B,CAAC;AACtE,OAAO,CAAC,6BAA6B,GAAG,6BAA6B,CAAC;AACtE,OAAO,CAAC,qCAAqC,GAAG,qCAAqC,CAAC;;AAEtF,OAAO,CAAC,SAAS,CAAC,kBAAkB;CACnC,uJAAuJ,CAAC;AACzJ,OAAO,CAAC,SAAS,CAAC,qBAAqB,GAAG,mCAAmC,CAAC;AAC9E,OAAO,CAAC,SAAS,CAAC,2BAA2B,GAAG,CAAC,mBAAmB,EAAE,mBAAmB,EAAE,GAAG,EAAE,GAAG,CAAC;EAClG,OAAO,CAAC,QAAQ,IAAI;EACpB,CAAC,SAAS,GAAG,QAAQ,GAAG,CAAC,EAAE,QAAQ,CAAC,wBAAwB,CAAC,EAAE,CAAC;EAChE,CAAC,gBAAgB,EAAE,QAAQ,CAAC,CAAC;EAC7B,CAAC;EACD,IAAI,CAAC,GAAG,CAAC,CAAC;;;;;;;;;yDAS6C;;AC/YxD;AACD,AAMA;;AAEA,AAAO,MAAM,sBAAsB,GAAG,UAAU,IAAI;;CAEnD,IAAI,QAAQ,EAAE,cAAc,EAAE,MAAM,EAAE,YAAY,CAAC;;CAEnD,OAAO,CAAC,sBAAsB,CAAC,QAAQ;GACrC,OAAO,CAAC,sBAAsB,CAAC,QAAQ,GAAG,QAAQ,CAAC,aAAa,CAAC,UAAU,CAAC,CAAC,CAAC;;CAEhF,OAAO,CAAC,sBAAsB,CAAC,QAAQ,CAAC,SAAS,GAAG,YAAY,GAAGgB,MAAe;GAChF,MAAM,GAAGC,QAAiB,EAAE,cAAc,GAAGC,SAAkB,CAAC,UAAU,CAAC,EAAE;EAC9E,CAAC;;;CAGF,QAAQ,GAAG,OAAO,CAAC,sBAAsB,CAAC,QAAQ,CAAC,OAAO,CAAC,SAAS,CAAC,IAAI,CAAC,CAAC;CAC3E,QAAQ,CAAC,QAAQ,GAAG,QAAQ,CAAC;CAC7B,QAAQ,CAAC,UAAU,GAAG,UAAU,CAAC;CACjC,QAAQ,CAAC,cAAc,GAAG,cAAc,CAAC;CACzC,QAAQ,CAAC,MAAM,GAAG,MAAM,CAAC;CACzB,QAAQ,CAAC,YAAY,GAAG,YAAY,CAAC;;CAErC,OAAO,QAAQ,CAAC;CAChB,CAAC;;;AAGF,sBAAsB,CAAC,QAAQ,GAAG,SAAS,CAAC;;;AAG5C,AAAO,MAAM,iCAAiC,GAAG,QAAQ,IAAI;CAC5D,KAAK,MAAM,IAAI,IAAI,QAAQ,CAAC,gBAAgB,CAAC,YAAY,CAAC,EAAE;EAC3D,IAAI,IAAI,CAAC,OAAO,CAAC,GAAG,CAAC,EAAE,SAAS;EAChC,MAAM,MAAM,GAAG,QAAQ,CAAC,aAAa,CAAC,GAAG,CAAC,CAAC;EAC3C,MAAM,CAAC,IAAI,GAAG,IAAI,CAAC,YAAY,CAAC,MAAM,CAAC,CAAC;EACxC,IAAI,CAAC,MAAM,CAAC,MAAM,CAAC,CAAC;EACpB,MAAM,CAAC,MAAM,CAAC,GAAG,IAAI,CAAC,UAAU,CAAC,CAAC;EAClC,IAAI,CAAC,MAAM,EAAE,CAAC;EACd;CACD,CAAC;;;AAGF,AAAO,MAAM,2BAA2B,GAAG,QAAQ,IAAI;CACtD,MAAM,QAAQ,GAAG,EAAE,CAAC;;CAEpB,KAAK,MAAM,OAAO,IAAI,QAAQ,CAAC,gBAAgB,CAAC,CAAC,CAAC,EAAE,OAAO,CAAC,kBAAkB,CAAC,UAAU,CAAC,aAAa,CAAC,CAAC;EACxG,QAAQ,CAAC,IAAI;GACZ,OAAO,CAAC,gBAAgB,CAAC;IACxB,OAAO;IACP,UAAU;KACT,OAAO,CAAC,YAAY,CAAC,OAAO,CAAC,kBAAkB,CAAC,UAAU,CAAC;KAC3D,OAAO,CAAC,YAAY,CAAC,OAAO,CAAC,kBAAkB,CAAC,UAAU,CAAC;IAC5D,UAAU,EAAE,OAAO,CAAC,WAAW;IAC/B,CAAC;GACF,CAAC;;CAEH,OAAO,QAAQ,CAAC,MAAM,GAAG,OAAO,CAAC,GAAG,CAAC,QAAQ,CAAC,GAAG,OAAO,CAAC,OAAO,EAAE,CAAC;CACnE,CAAC;;AAEF,OAAO,CAAC,sBAAsB,GAAG,sBAAsB,CAAC;AACxD,OAAO,CAAC,iCAAiC,GAAG,iCAAiC,CAAC;AAC9E,OAAO,CAAC,2BAA2B,GAAG,2BAA2B,CAAC;;sDAEZ;;ACpErD;AACD,AAUA;;AAEA,AAAO,MAAM,wBAAwB,GAAG,QAAQ,IAAI;CACnD,IAAI,CAAC,QAAQ,IAAI,QAAQ,CAAC,MAAM,EAAE,OAAO;CACzC,QAAQ,CAAC,MAAM,GAAG,EAAE,CAAC;;CAErB,KAAK,MAAM,IAAI,mCAAmC,QAAQ,CAAC,gBAAgB,CAAC,OAAO,CAAC,iBAAiB,CAAC,GAAG;EACxG,IAAI,IAAI,CAAC,QAAQ,KAAK,QAAQ,EAAE;GAC/B,IAAI,IAAI,CAAC,IAAI,KAAK,QAAQ,EAAE;IAC3B,CAAC,QAAQ,CAAC,MAAM,CAAC,OAAO,KAAK,QAAQ,CAAC,MAAM,CAAC,OAAO,GAAG,EAAE,CAAC,EAAE,IAAI,mCAAmC,IAAI,EAAE,CAAC;IAC1G,MAAM,IAAI,CAAC,IAAI,CAAC,IAAI,IAAI,IAAI,CAAC,IAAI,CAAC,IAAI,EAAE,CAAC,WAAW,EAAE,KAAK,iBAAiB,EAAE;IAC9E,CAAC,QAAQ,CAAC,MAAM,CAAC,OAAO,KAAK,QAAQ,CAAC,MAAM,CAAC,OAAO,GAAG,EAAE,CAAC,EAAE,IAAI,mCAAmC,IAAI,EAAE,CAAC;IAC1G;GACD,MAAM,IAAI,IAAI,CAAC,QAAQ,KAAK,OAAO,EAAE;GACrC,IAAI,CAAC,IAAI,CAAC,IAAI,IAAI,IAAI,CAAC,IAAI,CAAC,IAAI,EAAE,CAAC,WAAW,EAAE,KAAK,UAAU,EAAE;IAChE,CAAC,QAAQ,CAAC,MAAM,CAAC,WAAW,KAAK,QAAQ,CAAC,MAAM,CAAC,WAAW,GAAG,EAAE,CAAC,EAAE,IAAI;sCACtC,IAAI;KACrC,CAAC;IACF;GACD,MAAM;wBACe;IACpB,QAAQ,CAAC,MAAM,CAAC,OAAO,CAAC,YAAY,CAAC,IAAI,CAAC,QAAQ,CAAC,CAAC;;KAEnD,QAAQ,CAAC,MAAM,CAAC,OAAO,CAAC,YAAY,CAAC,IAAI,CAAC,QAAQ,CAAC,CAAC,GAAG,EAAE,CAAC;KAC1D,IAAI,CAAC,IAAI,CAAC,CAAC;GACb;EACD,QAAQ,CAAC,MAAM,CAAC,IAAI,CAAC,IAAI,CAAC,CAAC;EAC3B;;CAED,OAAO,QAAQ,CAAC;CAChB,CAAC;;;AAGF,AAAO,MAAM,uBAAuB,GAAG,QAAQ,IAAI;CAClD,KAAK,MAAM,KAAK,IAAI,QAAQ,CAAC,gBAAgB,CAAC,iCAAiC,CAAC,EAAE;EACjF,KAAK,CAAC,QAAQ,KAAK,IAAI,IAAI,KAAK,CAAC,MAAM,CAAC,GAAG,KAAK,CAAC,UAAU,CAAC,CAAC;EAC7D,KAAK,CAAC,MAAM,EAAE,CAAC;EACf;CACD,CAAC;;AAEF,AAAO,MAAM,YAAY,GAAG,IAAI,CAAC;CAChC,GAAG,EAAE,QAAQ;CACb,MAAM,EAAE,SAAS;CACjB,KAAK,EAAE,QAAQ;CACf,CAAC,CAAC;;AAEH,AAAO,MAAM,iBAAiB,GAAG,CAAC,QAAQ,EAAE,OAAO,EAAE,GAAG,MAAM,CAAC,IAAI,CAAC,YAAY,CAAC,CAAC;EAChF,GAAG,CAAC,GAAG,IAAI,CAAC,EAAE,GAAG,CAAC,WAAW,EAAE,CAAC,kBAAkB,EAAE,GAAG,CAAC,WAAW,EAAE,CAAC,oBAAoB,CAAC,CAAC;EAC5F,IAAI,CAAC,GAAG,CAAC,CAAC;;AAEZ,OAAO,CAAC,iBAAiB,GAAG,iBAAiB,CAAC;AAC9C,OAAO,CAAC,YAAY,GAAG,YAAY,CAAC;AACpC,OAAO,CAAC,wBAAwB,GAAG,wBAAwB,CAAC;AAC5D,OAAO,CAAC,uBAAuB,GAAG,uBAAuB,CAAC;;;;wDAIF;;ACpEvD;AACD,AAIA;AACA,AAAO,MAAM,cAAc,SAAS,SAAS,CAAC;;CAE7C,WAAW,KAAK,GAAG;;EAElB,MAAM,KAAK,GAAG,MAAM,CAAC,MAAM,CAAC,KAAK,CAAC,KAAK,IAAI,IAAI,CAAC,CAAC;;EAEjD,KAAK,MAAM,IAAI,IAAI,OAAO,CAAC,QAAQ,CAAC,KAAK,EAAE;GAC1C,MAAM,KAAK,GAAG,MAAM,CAAC,IAAI,CAAC,CAAC,gBAAgB,EAAE,IAAI,CAAC,OAAO,CAAC,IAAI,EAAE,GAAG,CAAC,CAAC,WAAW,CAAC,CAAC,CAAC,CAAC;GACpF,KAAK,KAAK,SAAS,KAAK,KAAK,CAAC,IAAI,CAAC,GAAG,KAAK,CAAC,CAAC;GAC7C;;EAED,OAAO,KAAK,CAAC,GAAG,CAAC,OAAO,EAAE,MAAM,CAAC,MAAM,CAAC,KAAK,CAAC,CAAC,CAAC;EAChD;;CAED,WAAW,QAAQ,GAAG;EACrB,OAAO,KAAK,CAAC,GAAG;GACf,UAAU;GACV,IAAI,CAAC,IAAI,WAAW,CAAC;;;;;;;GAOrB,CAAC;GACD,CAAC;EACF;;CAED,WAAW,UAAU,GAAG;EACvB,OAAO,KAAK,CAAC,GAAG,CAAC,YAAY,iCAAiC,CAAC,IAAI,EAAE,QAAQ,CAAC,EAAE,CAAC;EACjF;;CAED,WAAW,MAAM,GAAG;EACnB,OAAO,KAAK,CAAC,GAAG,CAAC,QAAQ,EAAE,IAAI,IAAI,CAAC,MAAM,CAAC,CAAC,IAAI,EAAE,IAAI,GAAG,CAAC,KAAK,EAAE,MAAM,CAAC,IAAI,CAAC,GAAG,CAAC,CAAC,EAAE,0BAA0B,CAAC,CAAC,CAAC;EACjH;;CAED,WAAW,MAAM,GAAG;EACnB,OAAO,KAAK,CAAC,GAAG;GACf,QAAQ;GACR,IAAI,CAAC,GAAG,UAAU,CAAC;aACT,EAAE,cAAc,CAAC,MAAM,CAAC,0BAA0B,CAAC,CAAC;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;GA+C9D,CAAC;GACD,CAAC;EACF;;CAED,WAAW,GAAG;EACb,KAAK,EAAE,CAAC;;EAER,IAAI,CAAC,KAAK,GAAG,GAAG,CAAC,MAAM,CAAC,KAAK,CAAC;;EAE9B,IAAI,CAAC,IAAI,GAAG,CAAC,EAAE,IAAI,CAAC,OAAO,CAAC,CAAC,EAAE,EAAE,GAAG,CAAC,MAAM,CAAC,QAAQ,CAAC,CAAC,CAAC,iBAAiB,EAAE,CAAC;;iCAE5C,MAAM,IAAI,GAAG,IAAI,CAAC,IAAI,CAAC,CAAC;EACvD,IAAI;GACH,IAAI,CAAC,gBAAgB;IACpB,YAAY;gCACgB,KAAK,IAAI,IAAI,CAAC,WAAW,IAAI,IAAI,CAAC,oBAAoB,CAAC,IAAI,CAAC;IACxF;KACC,OAAO,EAAE,IAAI;KACb;IACD,CAAC;EACH;;CAED,iBAAiB,GAAG;EACnB,cAAc,IAAI,IAAI,KAAK,IAAI,CAAC,QAAQ,GAAG,IAAI,CAAC,oBAAoB,CAAC,IAAI,CAAC,UAAU,CAAC,CAAC,CAAC;EACvF,KAAK,CAAC,iBAAiB,EAAE,CAAC;EAC1B;;CAED,cAAc,CAAC,MAAM,EAAE;;EAEtB,IAAI,MAAM,CAAC;;EAEX,MAAM,CAAC,WAAW,EAAE,WAAW,CAAC,GAAG,IAAI,CAAC;EACxC,IAAI,OAAO,MAAM,KAAK,QAAQ,IAAI,CAAC,MAAM,GAAG,MAAM,CAAC,IAAI,EAAE,MAAM,EAAE,EAAE;GAClE,MAAM,GAAG,MAAM,CAAC,iBAAiB,EAAE,CAAC,OAAO,CAAC,OAAO,EAAE,EAAE,CAAC,CAAC;GACzD,CAAC,MAAM,GAAG,WAAW,CAAC,aAAa,CAAC,CAAC,MAAM,EAAE,MAAM,CAAC,EAAE,CAAC,CAAC;MACrD,MAAM,CAAC,cAAc,CAAC,CAAC,QAAQ,EAAE,QAAQ,EAAE,KAAK,EAAE,OAAO,EAAE,MAAM,EAAE,SAAS,CAAC,CAAC;MAC9E,OAAO,CAAC,IAAI,CAAC,oBAAoB,EAAE,CAAC,MAAM,EAAE,MAAM,CAAC,CAAC,CAAC;GACxD;EACD;;CAED,MAAM,oBAAoB,CAAC,IAAI,GAAG,IAAI,CAAC,IAAI,CAAC,EAAE;EAC7C,MAAM,aAAa,GAAG,IAAI,IAAI,IAAI,CAAC,aAAa,EAAE,CAAC;EACnD,IAAI,aAAa,CAAC,MAAM,EAAE;GACzB,QAAQ,IAAI,CAAC,QAAQ,GAAG,IAAI,CAAC,oBAAoB,CAAC,IAAI,CAAC,UAAU,IAAI,EAAE,CAAC,EAAE;GAC1E;EACD;;;CAGD,MAAM,oBAAoB,CAAC,UAAU,EAAE;;EAEtC,IAAI,WAAW,CAAC;;EAEhB,IAAI,WAAW,CAAC;;EAEhB,IAAI,SAAS,CAAC;;;EAGd,CAAC,CAAC,WAAW,EAAE,WAAW,EAAE,UAAU,EAAE,WAAW,EAAE,SAAS,CAAC,GAAG,IAAI,EAAE;;EAExE,SAAS,CAAC,MAAM,KAAK,UAAU,GAAG,IAAI,CAAC,UAAU,CAAC,CAAC;;EAEnD,IAAI,UAAU,KAAK,IAAI,CAAC,kBAAkB,CAAC,EAAE,OAAO;EACpD,IAAI,CAAC,oBAAoB,CAAC,GAAG,SAAS,CAAC;EACvC,IAAI,CAAC,UAAU,EAAE,OAAO,MAAM,IAAI,CAAC,kBAAkB,CAAC,GAAG,WAAW,CAAC,WAAW,GAAG,EAAE,CAAC,CAAC;;EAEvF,WAAW,CAAC,KAAK,CAAC,UAAU,GAAG,WAAW,CAAC,KAAK,CAAC,UAAU,GAAG,IAAI,CAAC;EACnE,WAAW,CAAC,MAAM,GAAG,WAAW,CAAC,MAAM,GAAG,IAAI,CAAC;EAC/C,WAAW,CAAC,SAAS,CAAC,GAAG,CAAC,MAAM,CAAC,CAAC;EAClC,WAAW,CAAC,SAAS,CAAC,GAAG,CAAC,MAAM,CAAC,CAAC;;EAElC,MAAM,IAAI,OAAO,CAAC,OAAO,IAAI,qBAAqB,CAAC,OAAO,CAAC,CAAC,CAAC;;EAE7D,WAAW,CAAC,KAAK,CAAC,UAAU,GAAG,WAAW,CAAC,KAAK,CAAC,UAAU,GAAG,EAAE,CAAC;EACjE,WAAW,CAAC,SAAS,CAAC,MAAM,CAAC,MAAM,CAAC,CAAC;EACrC,WAAW,CAAC,MAAM,GAAG,KAAK,CAAC;;EAE3B,WAAW,CAAC,WAAW,GAAG,EAAE,CAAC;EAC7B,MAAM,QAAQ,IAAI,IAAI,CAAC,oBAAoB,CAAC,GAAG,MAAM,IAAI,CAAC,oBAAoB,CAAC,UAAU,EAAE,WAAW,EAAE,SAAS,CAAC,CAAC,CAAC;;EAEpH,IAAI,CAAC,kBAAkB,CAAC,GAAG,UAAU,CAAC;;EAEtC,MAAM,OAAO,GAAG,IAAI,OAAO,CAAC,OAAO,IAAI,UAAU,CAAC,OAAO,EAAE,GAAG,CAAC,CAAC,CAAC;;EAEjE,QAAQ,CAAC,MAAM,KAAK,IAAI;GACvB,OAAO,QAAQ,CAAC,MAAM,KAAK,QAAQ;IAClC,QAAQ,CAAC,mBAAmB,CAAC,oBAAoB,KAAK,IAAI;KACzD,QAAQ,CAAC,mBAAmB,CAAC,oBAAoB,KAAK,KAAK;KAC3D,QAAQ,CAAC,mBAAmB,CAAC,aAAa,KAAK,KAAK,CAAC,CAAC;IACvD,QAAQ,CAAC,MAAM,CAAC,OAAO,IAAI,QAAQ,CAAC,MAAM,CAAC,OAAO,CAAC,OAAO,CAAC,IAAI,CAAC,uBAAuB,EAAE,IAAI,CAAC;GAC/F,QAAQ,CAAC,MAAM,CAAC,OAAO,IAAI,QAAQ,CAAC,MAAM,CAAC,OAAO,CAAC,OAAO,CAAC,IAAI,CAAC,uBAAuB,EAAE,IAAI,CAAC,CAAC,CAAC;;EAEjG,MAAM,OAAO,CAAC,IAAI,CAAC,CAAC,cAAc,CAAC,MAAM,CAAC,0BAA0B,CAAC,EAAE,OAAO,CAAC,CAAC,CAAC;;EAEjF,MAAM,OAAO,CAAC;;EAEd,WAAW,CAAC,SAAS,CAAC,MAAM,CAAC,MAAM,CAAC,CAAC;EACrC,WAAW,CAAC,MAAM,GAAG,KAAK,CAAC;;;EAG3B,IAAI,IAAI,CAAC,cAAc,EAAE;GACxB,MAAM,OAAO,GAAG,WAAW,CAAC,gBAAgB,CAAC,SAAS,CAAC,CAAC;;GAExD,OAAO,IAAI,IAAI,CAAC,cAAc,CAAC,CAAC,GAAG,OAAO,CAAC,CAAC,CAAC;GAC7C;EACD;;;CAGD,MAAM,oBAAoB,CAAC,UAAU,GAAG,IAAI,CAAC,UAAU,EAAE,WAAW,GAAG,IAAI,CAAC,WAAW,CAAC,EAAE,OAAO,GAAG,IAAI,CAAC,OAAO,EAAE;EACjH,MAAM,CAAC,QAAQ,CAAC,GAAG,OAAO,CAAC,sBAAsB,CAAC,UAAU,CAAC,CAAC;;EAE9D,QAAQ,CAAC,OAAO,GAAG,OAAO,CAAC;;EAE3B,OAAO,CAAC,yBAAyB,CAAC,QAAQ,EAAE,cAAc,CAAC,KAAK,CAAC,CAAC;;EAElE,WAAW,CAAC,WAAW;GACtB,OAAO,QAAQ,CAAC,YAAY,KAAK,QAAQ,CAAC,YAAY,GAAG,IAAI,CAAC,0BAA0B,CAAC,QAAQ,CAAC,CAAC,CAAC;GACpG,CAAC;;EAEF,OAAO,CAAC,IAAI,EAAE,WAAW,EAAE,UAAU,EAAE,QAAQ,EAAE,GAAG,QAAQ,CAAC,CAAC;EAC9D;;CAED,MAAM,0BAA0B,CAAC,QAAQ,EAAE;EAC1C,IAAI,QAAQ,CAAC,YAAY,EAAE,OAAO,QAAQ,CAAC,YAAY,CAAC;;EAExD,MAAM,QAAQ,GAAG,EAAE,CAAC;;EAEpB,CAAC,QAAQ,CAAC,mBAAmB,CAAC,qBAAqB,KAAK,IAAI;IAC1D,QAAQ,CAAC,mBAAmB,CAAC,qBAAqB,KAAK,KAAK;IAC5D,QAAQ,CAAC,mBAAmB,CAAC,aAAa,KAAK,KAAK,CAAC;GACtD,QAAQ,CAAC,IAAI,CAAC,OAAO,CAAC,2BAA2B,CAAC,QAAQ,CAAC,CAAC,CAAC;;EAE9D,CAAC,QAAQ,CAAC,mBAAmB,CAAC,eAAe,KAAK,IAAI;IACpD,QAAQ,CAAC,mBAAmB,CAAC,eAAe,KAAK,KAAK;IACtD,QAAQ,CAAC,mBAAmB,CAAC,aAAa,KAAK,KAAK,CAAC;GACtD,QAAQ,CAAC,IAAI,CAAC,IAAI,CAAC,mBAAmB,CAAC,QAAQ,CAAC,CAAC,CAAC;;EAEnD,QAAQ,CAAC,MAAM,KAAK,MAAM,OAAO,CAAC,GAAG,CAAC,QAAQ,CAAC,CAAC,CAAC;;EAEjD,OAAO,QAAQ,CAAC;EAChB;;CAED,MAAM,mBAAmB,CAAC,QAAQ,EAAE;EACnC,IAAI,QAAQ,CAAC,YAAY,EAAE,OAAO,QAAQ,CAAC,YAAY,CAAC;;EAExD,IAAI,QAAQ,CAAC,mBAAmB,CAAC,eAAe,EAAE;GACjD,OAAO,CAAC,wBAAwB,CAAC,QAAQ,CAAC,CAAC;;GAE3C,MAAM,OAAO,GAAG,QAAQ,CAAC,OAAO,IAAI,QAAQ,CAAC,OAAO,CAAC;;GAErD,KAAK,MAAM,IAAI,IAAI,QAAQ,CAAC,MAAM,EAAE;IACnC,MAAM,CAAC,IAAI,EAAE,aAAa,EAAE,CAAC,IAAI,CAAC,QAAQ,KAAK,QAAQ,GAAG,QAAQ,GAAG,KAAK,GAAG,YAAY,CAAC,GAAG,IAAI,CAAC,UAAU,CAAC;IAC7G,MAAM,IAAI,GAAG,aAAa,GAAG,aAAa,CAAC,KAAK,GAAG,OAAO,CAAC;IAC3D,aAAa,IAAI,IAAI,CAAC,eAAe,CAAC,MAAM,CAAC,CAAC;IAC9C,IAAI,CAAC,YAAY,CAAC,WAAW,EAAE,IAAI,CAAC,CAAC;IACrC,IAAI,YAAY,EAAE;KACjB,MAAM,SAAS,GAAG,YAAY,CAAC,IAAI,CAAC;KACpC,MAAM,CAAC,IAAI,CAAC,GAAG,YAAY,CAAC,KAAK,CAAC,KAAK,CAAC,IAAI,EAAE,CAAC,CAAC,CAAC;KACjD,IAAI,CAAC,YAAY,CAAC,CAAC,KAAK,EAAE,SAAS,CAAC,CAAC,EAAE,IAAI,CAAC,CAAC;KAC7C,IAAI,CAAC,YAAY,CAAC,SAAS,GAAG,IAAI,CAAC,SAAS,CAAC,GAAG,IAAI,GAAG,CAAC,IAAI,EAAE,IAAI,CAAC,EAAE,CAAC;KACtE;IACD;;GAED,QAAQ,CAAC,MAAM,CAAC,WAAW;IAC1B,QAAQ,CAAC,MAAM,CAAC,WAAW,CAAC,MAAM;IAClC,QAAQ,CAAC,OAAO;KACf,MAAM,CAAC,MAAM,CAAC,QAAQ,CAAC,aAAa,CAAC,OAAO,CAAC,EAAE;MAC9C,WAAW,EAAE,QAAQ,CAAC,MAAM,CAAC,WAAW;QACtC,GAAG,CAAC,UAAU,KAAK,UAAU,CAAC,MAAM,EAAE,EAAE,CAAC,SAAS,EAAE,UAAU,CAAC,GAAG,CAAC,EAAE,CAAC,CAAC,CAAC;QACxE,IAAI,CAAC,IAAI,CAAC;MACZ,CAAC;KACF,CAAC;GACH;;EAED,OAAO,QAAQ,CAAC;EAChB;;;CAGD,uBAAuB,CAAC,MAAM,EAAE;EAC/B,IAAI,MAAM,CAAC,gBAAgB,CAAC,KAAK,IAAI,IAAI,CAAC,MAAM,CAAC,WAAW,EAAE,OAAO;EACrE,MAAM,CAAC,gBAAgB,CAAC,GAAG,IAAI,CAAC;EAChC,MAAM,CAAC,MAAM,CAAC,QAAQ,CAAC,aAAa,CAAC,MAAM,CAAC,SAAS,CAAC,IAAI,EAAE,CAAC,CAAC,CAAC;EAC/D,MAAM,CAAC,MAAM,EAAE,CAAC;EAChB,MAAM,CAAC,GAAG,CAAC,UAAU,CAAC,QAAQ,CAAC,MAAM,CAAC;GACrC,eAAe,CAAC,IAAI,CAAC,QAAQ,CAAC,IAAI,CAAC;IAClC,MAAM,CAAC,GAAG,GAAG,MAAM,CAAC,GAAG,CAAC,OAAO;IAC/B,mBAAmB;IACnB,CAAC,CAAC,EAAE,KAAK,EAAE,IAAI,KAAK,CAAC,EAAE,KAAK,GAAG,CAAC,EAAE,KAAK,CAAC,CAAC,CAAC,GAAG,GAAG,CAAC,GAAG,EAAE,IAAI,CAAC,CAAC;IAC5D,CAAC,CAAC;;EAEJ,aAAa,CAAC,MAAM,CAAC,GAAG,CAAC,CAAC;EAC1B;;;CAGD,uBAAuB,CAAC,MAAM,EAAE;EAC/B,IAAI,MAAM,CAAC,gBAAgB,CAAC,KAAK,IAAI,IAAI,CAAC,MAAM,CAAC,WAAW,EAAE,OAAO;EACrE,IAAI,MAAM,CAAC,aAAa,CAAC,QAAQ,KAAK,QAAQ,EAAE;GAC/C,MAAM,CAAC,gBAAgB,CAAC,GAAG,IAAI,CAAC;GAChC,IAAI,CAAC,qBAAqB,CAAC,MAAM,CAAC,CAAC;GACnC;EACD;;CAED,MAAM,qBAAqB,CAAC,MAAM,EAAE;EACnC,MAAM,CAAC,GAAG,CAAC,GAAG,MAAM,CAAC;EACrB,MAAM,UAAU,GAAG,MAAM,CAAC,MAAM,KAAK,CAAC,GAAG,CAAC,EAAE,IAAI,EAAE,CAAC;EACnD,MAAM,IAAI,OAAO,CAAC,qBAAqB,CAAC,CAAC;EACzC,QAAQ,CAAC,mBAAmB,CAAC,GAAG,MAAM,CAAC;EACvC,CAAC,GAAG,IAAI,EAAE,CAAC,EAAE,UAAU,CAAC,sCAAsC,CAAC,CAAC,CAAC;EACjE;;;CAGD,IAAI,UAAU,GAAG;;EAEhB,MAAM,CAAC,UAAU,EAAE,iBAAiB,EAAE,YAAY,CAAC,GAAG,IAAI,CAAC;EAC3D,IAAI,YAAY,IAAI,YAAY,KAAK,EAAE,EAAE,OAAO,YAAY,CAAC;;EAE7D,IAAI,iBAAiB,IAAI,iBAAiB,CAAC,QAAQ,KAAK,UAAU,EAAE,OAAO,iBAAiB,CAAC,SAAS,CAAC,IAAI,EAAE,IAAI,EAAE,CAAC;;EAEpH,IAAI,UAAU,CAAC,MAAM,EAAE;GACtB,MAAM,SAAS,GAAG,IAAI,CAAC,SAAS,CAAC;GACjC,MAAM,GAAG,MAAM,CAAC,GAAG,gBAAgB,CAAC,IAAI,CAAC,SAAS,CAAC,CAAC;GACpD,OAAO,MAAM,GAAG,SAAS,CAAC,OAAO,CAAC,IAAI,MAAM,CAAC,CAAC,CAAC,EAAE,MAAM,CAAC,CAAC,EAAE,IAAI,CAAC,EAAE,EAAE,CAAC,GAAG,SAAS,CAAC,IAAI,EAAE,IAAI,EAAE,CAAC;GAC/F;EACD;;CAED,IAAI,UAAU,CAAC,UAAU,EAAE;EAC1B,IAAI,CAAC,QAAQ,GAAG,IAAI,CAAC,oBAAoB,CAAC,UAAU,CAAC,CAAC;EACtD;;;;CAID,WAAW,uBAAuB,GAAG;EACpC,OAAO,KAAK,CAAC,GAAG,CAAC,yBAAyB,EAAE,OAAO,CAAC,kBAAkB,CAAC,YAAY,CAAC,CAAC;EACrF;CACD,WAAW,qBAAqB,GAAG;EAClC,OAAO,KAAK,CAAC,GAAG,CAAC,uBAAuB,EAAE,OAAO,CAAC,kBAAkB,CAAC,UAAU,CAAC,CAAC;EACjF;CACD,WAAW,qBAAqB,GAAG;EAClC,OAAO,KAAK,CAAC,GAAG,CAAC,uBAAuB,EAAE,OAAO,CAAC,kBAAkB,CAAC,UAAU,CAAC,CAAC;EACjF;CACD;;AAED,IAAI;CACH,cAAc,CAAC,MAAM,CAAC,iBAAiB,EAAE,cAAc,CAAC,CAAC;CACzD,CAAC,OAAO,SAAS,EAAE;CACnB,OAAO,CAAC,IAAI,CAAC,SAAS,CAAC,CAAC;CACxB;;AClVA;AACD,MAAM,aAAa,GAAG,iFAAiF,CAAC;;AAExG,MAAM,CAAC,GAAG,EAAE,MAAM,EAAE,KAAK,EAAE,cAAc,EAAE,QAAQ,EAAE,GAAG,CAAC,GAAG,OAAO,CAAC;;AAEpE,AAAO,MAAM,cAAc,GAAG;CAC7B,OAAO;CACP,CAAC,SAAS,EAAE,OAAO,EAAE,MAAM,EAAE,QAAQ,GAAG,QAAQ,EAAE,SAAS,GAAG,MAAM,CAAC,IAAI,CAAC,8BAA8B,CAAC,CAAC;KACtG;CACJ,SAAS,IAAI,cAAc,CAAC,eAAe,EAAE,QAAQ,CAAC,CAAC;;CAEvD,KAAK,MAAM,MAAM,IAAI,OAAO,EAAE;EAC7B,MAAM,CAAC,OAAO,EAAE,MAAM,EAAE,IAAI,EAAE,SAAS,GAAG,KAAK,EAAE,KAAK,GAAG,EAAE,EAAE,IAAI,GAAG,EAAE,CAAC,GAAG,aAAa,CAAC,IAAI;GAC3F,MAAM,CAAC,YAAY,CAAC,MAAM,CAAC;GAC3B,CAAC;;EAEF,SAAS,IAAI,GAAG,CAAC,CAAC,OAAO,EAAE,MAAM,EAAE,IAAI,EAAE,SAAS,EAAE,KAAK,EAAE,IAAI,CAAC,CAAC,CAAC;;EAElE,IAAI,MAAM,EAAE;GACX,MAAM,QAAQ,GAAG,CAAC,EAAE,MAAM,CAAC,EAAE,IAAI,GAAG,CAAC,EAAE,IAAI,CAAC,EAAE,SAAS,CAAC,CAAC,GAAG,EAAE,CAAC,CAAC,CAAC;;GAEjE,MAAM,IAAI;IACT,IAAI,IAAI,SAAS,CAAC,WAAW,EAAE,KAAK,KAAK;OACtC,CAAC,EAAE,OAAO,CAAC,EAAE,MAAM,CAAC,CAAC,EAAE,IAAI,GAAG,CAAC,QAAQ,EAAE,SAAS,CAAC,CAAC,QAAQ,CAAC,EAAE,IAAI,CAAC,CAAC;OACrE,IAAI,GAAG,CAAC,CAAC,EAAE,QAAQ,CAAC,EAAE,KAAK,KAAK,CAAC,CAAC,IAAI,IAAI,MAAM,KAAK,EAAE,CAAC,CAAC,EAAE,IAAI,CAAC,CAAC,EAAE,SAAS,CAAC,CAAC;GAClF,MAAM,CAAC,IAAI,GAAG,IAAI,CAAC;GACnB,MAAM,IAAI,IAAI,EAAE;GAChB,MAAM,CAAC,IAAI,GAAG,CAAC,EAAE,QAAQ,CAAC,EAAE,OAAO,CAAC,CAAC,CAAC;GACtC,MAAM;GACN,MAAM,CAAC,MAAM,KAAK,MAAM,CAAC,MAAM,GAAG,QAAQ,CAAC,CAAC;GAC5C;;EAED,IAAI,SAAS,IAAI,IAAI,EAAE,SAAS;EAChC,SAAS,IAAI,MAAM,CAAC,MAAM,CAAC,CAAC;EAC5B;;CAED,SAAS,IAAI,QAAQ,EAAE,CAAC;CACxB,CAAC;AACF,AAGA;AACA,SAAS,CAAC,SAAS,EAAE,MAAM,CAAC,IAAI,EAAE;;CAEjC,OAAO,QAAQ,KAAK,QAAQ,IAAI,uCAAuC,CAAC,IAAI,CAAC,QAAQ,CAAC,MAAM,CAAC;CAC7F,gBAAgB;CAChB,CAAC,CAAC;;AC3CH,CAAC,YAAY;CACZ,MAAM,cAAc,CAAC,WAAW,CAAC,iBAAiB,CAAC,CAAC;;;CAGpD,MAAM,cAAc,GAAG,cAAc,CAAC,GAAG,CAAC,iBAAiB,CAAC,CAAC;;;;;CAK7D,MAAM,sBAAsB,GAAG,cAAc,cAAc,CAAC;EAC3D,MAAM,IAAI,CAAC,GAAG,EAAE;AAClB,AACA,GAAG,SAAS,CAAC,MAAM,KAAK,GAAG,GAAG,IAAI,CAAC,YAAY,CAAC,KAAK,CAAC,CAAC,CAAC;GACrD,IAAI,CAAC,GAAG,EAAE,OAAO;GACjB,MAAM,GAAG,GAAG,IAAI,GAAG,CAAC,GAAG,EAAE,IAAI,CAAC,OAAO,CAAC,CAAC;GACvC,MAAM,QAAQ,GAAG,MAAM,KAAK,CAAC,GAAG,CAAC,CAAC;GAClC,IAAI,CAAC,QAAQ,CAAC,EAAE,EAAE,MAAM,KAAK,CAAC,CAAC,gBAAgB,EAAE,GAAG,CAAC,CAAC,CAAC,CAAC;GACxD,MAAM,IAAI,GAAG,MAAM,QAAQ,CAAC,IAAI,EAAE,CAAC;GACnC,IAAI,CAAC,SAAS,GAAG,GAAG,CAAC;GACrB,IAAI,CAAC,UAAU,GAAG,IAAI,IAAI,EAAE,CAAC;GAC7B;;;;;;EAMD,cAAc,CAAC,GAAG,OAAO,EAAE;GAC1B,MAAM,SAAS,GAAG,MAAM,CAAC,IAAI,CAAC,8BAA8B,CAAC,CAAC;GAC9D,MAAM,QAAQ,GAAG,IAAI,CAAC;GACtB,MAAM,CAAC,SAAS,EAAE,OAAO,GAAG,CAAC,SAAS,CAAC,CAAC,GAAG,QAAQ,CAAC;GACpD,MAAM,MAAM,GAAG,QAAQ,CAAC,MAAM,IAAI,EAAE,CAAC;GACrCC,cAAsB,CAAC,OAAO,CAAC,IAAI,EAAE,EAAE,CAAC,SAAS,EAAE,SAAS,EAAE,OAAO,EAAE,MAAM,EAAE,QAAQ,CAAC,CAAC,CAAC;GAC1F;EACD,CAAC;;CAEF,MAAM,QAAQ,GAAG,QAAQ,CAAC,IAAI,CAAC,gBAAgB,CAAC,sBAAsB,CAAC,CAAC;CACxE,IAAI,QAAQ,EAAE;EACb,MAAM,CAAC,IAAI,EAAE,cAAc,CAAC,GAAG,sBAAsB,CAAC,SAAS,CAAC;EAChE,KAAK,MAAM,OAAO,IAAI,QAAQ,EAAE;GAC/B,OAAO,CAAC,IAAI,KAAK,CAAC,OAAO,CAAC,IAAI,GAAG,IAAI,GAAG,OAAO,CAAC,cAAc,KAAK,OAAO,CAAC,cAAc,GAAG,cAAc,CAAC,CAAC;IAC3G,OAAO,CAAC,IAAI,EAAE,CAAC,KAAK,CAAC,SAAS,KAAK,OAAO,CAAC,UAAU,GAAG,CAAC,KAAK,EAAE,SAAS,CAAC,MAAM,CAAC,CAAC,CAAC,CAAC;GACrF;EACD;CACD,GAAG,CAAC;AACL,AAGA;;;AAGA,SAAS,CAAC,SAAS,EAAE,MAAM,CAAC,IAAI,EAAE;;;;CAIjC,aAAa,CAAC,IAAI,CAAC,MAAM,CAAC,IAAI,CAAC,GAAG,CAAC,IAAI,aAAa,CAAC,IAAI,CAAC,QAAQ,CAAC,MAAM,CAAC;CAC1E,gBAAgB;CAChB,CAAC,CAAC"}